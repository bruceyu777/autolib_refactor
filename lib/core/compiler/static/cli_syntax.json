{
  "schema_version": "2.0",
  "description": "Enhanced API schema with full parameter metadata for validation and documentation",
  "developer note": "If you add a new API, make sure to update both the syntax definition file and its implementation, as they must stay in sync!",
  "apis": {
    "expect": {
      "description": "Expect pattern in output with optional retry logic",
      "category": "expect",
      "parse_mode": "options",
      "parameters": {
        "-e": {
          "alias": "rule",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Regular expression pattern to match in device output"
        },
        "-for": {
          "alias": "qaid",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "Test case ID for result reporting"
        },
        "-t": {
          "alias": "wait_seconds",
          "type": "int",
          "position": 2,
          "default": 5,
          "required": false,
          "description": "Timeout in seconds to wait for pattern"
        },
        "-fail": {
          "alias": "fail_match",
          "type": "string",
          "position": 3,
          "default": "unmatch",
          "enum": ["match", "unmatch"],
          "required": false,
          "description": "Fail condition: 'match' means pattern found fails, 'unmatch' means pattern found succeeds"
        },
        "-b": {
          "alias": "before",
          "type": "string",
          "position": 4,
          "required": false,
          "description": "Unused legacy parameter"
        },
        "-a": {
          "alias": "after",
          "type": "string",
          "position": 5,
          "required": false,
          "description": "Unused legacy parameter"
        },
        "-clear": {
          "alias": "clear",
          "type": "string",
          "position": 6,
          "default": "yes",
          "enum": ["yes", "no"],
          "required": false,
          "description": "Clear device buffer before expecting"
        },
        "-retry_command": {
          "alias": "retry_command",
          "type": "string",
          "position": 7,
          "required": false,
          "description": "Command to execute on retry if expect fails"
        },
        "-retry_cnt": {
          "alias": "retry_cnt",
          "type": "int",
          "position": 8,
          "default": 3,
          "required": false,
          "description": "Maximum number of retry attempts"
        }
      }
    },
    "expect_ctrl_c": {
      "description": "Send Ctrl+C then expect pattern",
      "category": "expect",
      "parse_mode": "options",
      "parameters": {
        "-e": {
          "alias": "rule",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Pattern to match"
        },
        "-for": {
          "alias": "qaid",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "Test case ID"
        },
        "-t": {
          "alias": "wait_seconds",
          "type": "int",
          "position": 2,
          "default": 5,
          "required": false,
          "description": "Timeout in seconds"
        },
        "-fail": {
          "alias": "fail_match",
          "type": "string",
          "position": 3,
          "default": "unmatch",
          "required": false,
          "enum": ["match", "unmatch"],
          "description": "Fail condition"
        },
        "-b": {
          "alias": "before",
          "type": "string",
          "position": 4,
          "required": false
        },
        "-a": {
          "alias": "after",
          "type": "string",
          "position": 5,
          "required": false
        },
        "-clear": {
          "alias": "clear",
          "type": "string",
          "position": 6,
          "default": "yes",
          "required": false,
          "enum": ["yes", "no"],
          "description": "Clear buffer"
        },
        "-retry_command": {
          "alias": "retry_command",
          "type": "string",
          "position": 7,
          "required": false,
          "description": "Retry command"
        },
        "-retry_cnt": {
          "alias": "retry_cnt",
          "type": "int",
          "position": 8,
          "default": 3,
          "required": false,
          "description": "Retry count"
        }
      }
    },
    "expect_OR": {
      "description": "Expect one of two patterns (logical OR)",
      "category": "expect",
      "parse_mode": "options",
      "parameters": {
        "-e1": {
          "alias": "rule1",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "First pattern to match"
        },
        "-e2": {
          "alias": "rule2",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "Second pattern to match"
        },
        "-fail1": {
          "alias": "fail1_match",
          "type": "string",
          "position": 2,
          "default": "unmatch",
          "required": false,
          "enum": ["match", "unmatch"],
          "description": "Fail condition for first pattern"
        },
        "-fail2": {
          "alias": "fail2_match",
          "type": "string",
          "position": 3,
          "default": "unmatch",
          "required": false,
          "enum": ["match", "unmatch"],
          "description": "Fail condition for second pattern"
        },
        "-for": {
          "alias": "qaid",
          "type": "string",
          "position": 4,
          "required": true,
          "description": "Test case ID"
        },
        "-t": {
          "alias": "wait_seconds",
          "type": "int",
          "position": 5,
          "default": 5,
          "required": false,
          "description": "Timeout in seconds"
        }
      }
    },
    "varexpect": {
      "description": "Expect variable value in output",
      "category": "expect",
      "parse_mode": "options",
      "parameters": {
        "-e": {
          "alias": "expect_str",
          "type": "string",
          "position": 0,
          "required": false,
          "description": "Unused"
        },
        "-v": {
          "alias": "variable",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "Variable name whose value to expect"
        },
        "-for": {
          "alias": "qaid",
          "type": "string",
          "position": 2,
          "required": true,
          "description": "Test case ID"
        },
        "-t": {
          "alias": "wait_seconds",
          "type": "int",
          "position": 3,
          "default": 5,
          "required": false,
          "description": "Timeout in seconds"
        },
        "-fail": {
          "alias": "fail_match",
          "type": "string",
          "position": 4,
          "default": "unmatch",
          "required": false,
          "description": "Fail condition"
        },
        "-b": {
          "alias": "before",
          "type": "string",
          "position": 5,
          "required": false
        }
      }
    },
    "setvar": {
      "description": "Extract value from pattern match and set variable",
      "category": "variable",
      "parse_mode": "options",
      "parameters": {
        "-e": {
          "alias": "rule",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Regex pattern with capture group"
        },
        "-to": {
          "alias": "name",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "Variable name to set"
        }
      }
    },
    "setenv": {
      "description": "Set environment variable for specific device",
      "category": "variable",
      "parse_mode": "options",
      "parameters": {
        "-n": {
          "alias": "var_name",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Variable name"
        },
        "-v": {
          "alias": "var_val",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "Variable value"
        },
        "-d": {
          "alias": "device_name",
          "type": "string",
          "position": 2,
          "required": true,
          "description": "Device name"
        }
      }
    },
    "compare": {
      "description": "Compare two variables and record result",
      "category": "variable",
      "parse_mode": "options",
      "parameters": {
        "-v1": {
          "alias": "var1",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "First variable name"
        },
        "-v2": {
          "alias": "var2",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "Second variable name"
        },
        "-for": {
          "alias": "qaid",
          "type": "string",
          "position": 2,
          "required": true,
          "description": "Test case ID"
        },
        "-fail": {
          "alias": "fail_match",
          "type": "string",
          "position": 3,
          "default": "uneq",
          "required": false,
          "enum": ["eq", "uneq"],
          "description": "Fail if equal or unequal"
        }
      }
    },
    "myftp": {
      "description": "Execute FTP with pattern matching",
      "category": "network",
      "parse_mode": "options",
      "parameters": {
        "-e": {
          "alias": "rule",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Pattern to match"
        },
        "-ip": {
          "alias": "ip",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "FTP server IP address"
        },
        "-for": {
          "alias": "qaid",
          "type": "string",
          "position": 2,
          "required": false,
          "description": "Test case ID"
        },
        "-fail": {
          "alias": "fail_match",
          "type": "string",
          "position": 3,
          "default": "unmatch",
          "required": false,
          "description": "Fail condition"
        },
        "-t": {
          "alias": "wait_seconds",
          "type": "int",
          "position": 4,
          "default": 5,
          "required": false,
          "description": "Timeout in seconds"
        },
        "-u": {
          "alias": "user_name",
          "type": "string",
          "position": 5,
          "required": true,
          "description": "FTP username"
        },
        "-p": {
          "alias": "password",
          "type": "string",
          "position": 6,
          "required": true,
          "description": "FTP password"
        },
        "-c": {
          "alias": "command",
          "type": "string",
          "position": 7,
          "required": false,
          "description": "FTP command to execute"
        },
        "-a": {
          "alias": "action",
          "type": "string",
          "position": 8,
          "default": "continue",
          "required": false,
          "enum": ["stop", "continue", "nextgroup"],
          "description": "Action on failure"
        }
      }
    },
    "mytelnet": {
      "description": "Execute Telnet with pattern matching",
      "category": "network",
      "parse_mode": "options",
      "parameters": {
        "-d": {
          "alias": "unused",
          "type": "string",
          "position": 0,
          "required": false
        },
        "-e": {
          "alias": "rule",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "Pattern to match"
        },
        "-ip": {
          "alias": "ip",
          "type": "string",
          "position": 2,
          "required": true,
          "description": "Telnet server IP"
        },
        "-for": {
          "alias": "qaid",
          "type": "string",
          "position": 3,
          "required": true,
          "description": "Test case ID"
        },
        "-fail": {
          "alias": "fail_match",
          "type": "string",
          "position": 4,
          "default": "unmatch",
          "required": false,
          "description": "Fail condition"
        },
        "-t": {
          "alias": "wait_seconds",
          "type": "int",
          "position": 5,
          "default": 5,
          "required": false,
          "description": "Timeout in seconds"
        },
        "-u": {
          "alias": "user_name",
          "type": "string",
          "position": 6,
          "required": true,
          "description": "Username"
        },
        "-p": {
          "alias": "password",
          "type": "string",
          "position": 7,
          "required": true,
          "description": "Password"
        }
      }
    },
    "report": {
      "description": "Mark test case for reporting",
      "category": "report",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "qaid",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Test case ID to report"
        }
      ]
    },
    "collect_dev_info": {
      "description": "Collect device information for test case",
      "category": "report",
      "parse_mode": "options",
      "parameters": {
        "-for": {
          "alias": "qaid",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Test case ID"
        }
      }
    },
    "setlicense": {
      "description": "Set license variable",
      "category": "report",
      "parse_mode": "options",
      "parameters": {
        "-t": {
          "alias": "lic_type",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "License Type, such as: 04V"
        },
        "-for": {
          "alias": "sub_type",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "License Sub-Type, such as VDOM"
        },
        "-to": {
          "alias": "var_name",
          "type": "string",
          "position": 2,
          "required": true,
          "description": "Variable to store license"
        }
      }
    },
    "sleep": {
      "description": "Sleep for specified seconds",
      "category": "utility",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "seconds",
          "type": "int",
          "position": 0,
          "required": true,
          "description": "Number of seconds to sleep"
        }
      ]
    },
    "comment": {
      "description": "Add comment to logs and summary",
      "category": "utility",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "comment_text",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Comment text"
        }
      ]
    },
    "breakpoint": {
      "description": "Pause execution and enter debugger",
      "category": "utility",
      "parse_mode": "positional",
      "parameters": []
    },
    "enter_dev_debugmode": {
      "description": "Enter Python pdb debugger",
      "category": "utility",
      "parse_mode": "positional",
      "parameters": []
    },
    "clearbuff": {
      "description": "Clear device buffer",
      "category": "buffer",
      "parse_mode": "positional",
      "parameters": []
    },
    "clean_buffer": {
      "description": "Clear device buffer (alias)",
      "category": "buffer",
      "parse_mode": "positional",
      "parameters": []
    },
    "clear_buffer": {
      "description": "Clear device buffer (alias)",
      "category": "buffer",
      "parse_mode": "positional",
      "parameters": []
    },
    "forcelogin": {
      "description": "Force login to current device",
      "category": "device",
      "parse_mode": "positional",
      "parameters": []
    },
    "auto_login": {
      "description": "Enable or disable automatic login",
      "category": "device",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "enabled",
          "type": "int",
          "position": 0,
          "required": true,
          "description": "1 to enable, 0 to disable"
        }
      ]
    },
    "keep_running": {
      "description": "Set keep_running flag for device",
      "category": "device",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "enabled",
          "type": "int",
          "position": 0,
          "required": true,
          "description": "1 to enable, 0 to disable"
        }
      ]
    },
    "confirm_with_newline": {
      "description": "Set confirm_with_newline flag",
      "category": "device",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "enabled",
          "type": "int",
          "position": 0,
          "required": true,
          "description": "1 to enable, 0 to disable"
        }
      ]
    },
    "wait_for_confirm": {
      "description": "Set wait_for_confirm flag",
      "category": "device",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "enabled",
          "type": "int",
          "position": 0,
          "required": true,
          "description": "1 to enable, 0 to disable"
        }
      ]
    },
    "restore_image": {
      "description": "Restore device image to specific release and build",
      "category": "device",
      "parse_mode": "options",
      "parameters": {
        "-v": {
          "alias": "release",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Release version"
        },
        "-b": {
          "alias": "build",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "Build number"
        }
      }
    },
    "resetFirewall": {
      "description": "Reset firewall configuration",
      "category": "device",
      "parse_mode": "positional",
      "parameters": []
    },
    "resetFAP": {
      "description": "Reset FAP device",
      "category": "device",
      "parse_mode": "positional",
      "parameters": []
    },
    "send_literal": {
      "description": "Send literal string with escape sequences",
      "category": "command",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "literal",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Double-quoted string with escape sequences"
        }
      ]
    },
    "include": {
      "description": "Include and execute another script",
      "category": "script",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "script_path",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Path to script to include"
        }
      ]
    },
    "strset": {
      "description": "Set string variable",
      "category": "variable",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "var_name",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Variable name (without $ prefix)"
        },
        {
          "name": "var_value",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "String value to assign"
        }
      ]
    },
    "intset": {
      "description": "Set integer variable",
      "category": "variable",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "var_name",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Variable name (without $ prefix)"
        },
        {
          "name": "var_value",
          "type": "int",
          "position": 1,
          "required": true,
          "description": "Integer value to assign"
        }
      ]
    },
    "listset": {
      "description": "Set list variable",
      "category": "variable",
      "parse_mode": "positional",
      "parameters": [
        {
          "name": "var_name",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Variable name (without $ prefix)"
        },
        {
          "name": "var_value",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "List value to assign (comma-separated)"
        }
      ]
    },
    "exec_code": {
      "description": "Execute code in specified language and store result in variable",
      "category": "code_execution",
      "parse_mode": "options",
      "parameters": {
        "-lang": {
          "alias": "lang",
          "type": "string",
          "position": 0,
          "required": true,
          "enum": ["python", "bash"],
          "description": "Programming language to execute (python|bash|javascript|ruby)"
        },
        "-var": {
          "alias": "var",
          "type": "string",
          "position": 1,
          "required": true,
          "description": "Variable name to store the execution result"
        },
        "-file": {
          "alias": "file",
          "type": "string",
          "position": 2,
          "required": true,
          "description": "Path to code file to execute"
        },
        "-func": {
          "alias": "func",
          "type": "string",
          "position": 3,
          "required": false,
          "description": "Function name to call when using -file"
        },
        "-args": {
          "alias": "args",
          "type": "string",
          "position": 4,
          "required": false,
          "description": "Comma-separated arguments to pass to function"
        },
        "-timeout": {
          "alias": "timeout",
          "type": "int",
          "position": 5,
          "required": false,
          "default": 30,
          "description": "Execution timeout in seconds"
        }
      }
    },
    "check_var": {
      "description": "Check if variable matches expected value and report result",
      "category": "variable",
      "parse_mode": "options",
      "parameters": {
        "-name": {
          "alias": "name",
          "type": "string",
          "position": 0,
          "required": true,
          "description": "Variable name to check"
        },
        "-value": {
          "alias": "value",
          "type": "string",
          "position": 1,
          "required": false,
          "description": "Expected exact value (mutually exclusive with -pattern and -contains)"
        },
        "-pattern": {
          "alias": "pattern",
          "type": "string",
          "position": 2,
          "required": false,
          "description": "Regular expression pattern to match (mutually exclusive with -value and -contains)"
        },
        "-contains": {
          "alias": "contains",
          "type": "string",
          "position": 3,
          "required": false,
          "description": "Substring that must be present (mutually exclusive with -value and -pattern)"
        },
        "-for": {
          "alias": "qaid",
          "type": "string",
          "position": 4,
          "required": true,
          "description": "Test case ID (QAID) for result reporting"
        },
        "-fail": {
          "alias": "fail_match",
          "type": "string",
          "position": 5,
          "required": false,
          "default": "unmatch",
          "enum": ["match", "unmatch"],
          "description": "Fail condition: 'match' (fail if matched) or 'unmatch' (fail if not matched)"
        }
      }
    }
  },
  "valid_commands": [
    "set",
    "edit",
    "config",
    "diag",
    "exe",
    "execute",
    "del",
    "next",
    "end",
    "unset",
    "show",
    "append",
    "select",
    "unselect",
    "purge",
    "get",
    "conf",
    "clear",
    "sh",
    "clone",
    "dia",
    "fnsysctl",
    "con",
    "y",
    "rename",
    "move",
    "admin",
    "sudo",
    "myset",
    "myend",
    "mynext",
    "mydelete",
    "myexec",
    "keep_running",
    "resetFirewall",
    "comment",
    "Comment",
    "ctrl_c",
    "nan_enter",
    "sleep",
    "clean_buffer",
    "expect_ctrl_c",
    "restore_image",
    "confirm_with_newline",
    "wait_for_confirm",
    "auto_login",
    "send_literal",
    "resetFAP"
  ],
  "script_types": [
    "api",
    "section",
    "command",
    "keyword",
    "include",
    "comment"
  ],
  "deprecated_commands": {
    "^myexe[^\\s]*\\s+(.*)$": "execute \\1",
    "^mynext(.*?)": "next",
    "^myset[^\\s]*\\s+(.*)$": "set \\1",
    "^mydel[^\\s]*\\s+(.*)$": "delete \\1",
    "^myend": "end",
    "^pcsend[^\\s]*\\s+(.*)$": "send_literal \"\\1\"",
    "^sendraw[^\\s]*\\s+(.*)$": "send_literal \"\\1\""
  },
  "keywords": {
    "if": {
      "type": "control_block",
      "flow": ["expression", "script", ["elseif", "else", "fi"]],
      "description": "Conditional execution block - executes code if condition is true",
      "syntax": "<if condition>\n  script...\n<fi>",
      "examples": [
        "<if $count eq 5>\n  echo Count is 5\n<fi>",
        "<if $STATUS eq success>\n  echo Success\n<elseif $STATUS eq pending>\n  echo Pending\n<else>\n  echo Failed\n<fi>"
      ],
      "notes": "Supports comparison operators: eq (equal), ne (not equal), lt (less than), > (greater than), < (less than). Must be closed with <fi>."
    },
    "elseif": {
      "type": "control_block",
      "flow": ["expression", "script", ["elseif", "else", "fi"]],
      "description": "Alternative conditional branch in if block",
      "syntax": "<elseif condition>\n  script...",
      "notes": "Must follow <if> or another <elseif>. Multiple <elseif> branches are allowed."
    },
    "else": {
      "type": "control_block",
      "flow": ["script", "fi"],
      "description": "Default branch when no conditions match",
      "syntax": "<else>\n  script...",
      "notes": "Must be the last branch before <fi>. Only one <else> allowed per if block."
    },
    "fi": {
      "type": "control_block",
      "flow": [],
      "description": "Closes an if/elseif/else block",
      "syntax": "<fi>",
      "notes": "Required to end every <if> block."
    },
    "loop": {
      "type": "control_block",
      "flow": ["expression", "script", "until"],
      "description": "Loop block - repeats until condition becomes true",
      "syntax": "<loop condition>\n  script...\n<until condition>",
      "examples": [
        "<loop $count lt 10>\n  <intchange $count + 1>\n<until $count eq 10>"
      ],
      "notes": "Executes body repeatedly. Must be closed with <until>."
    },
    "until": {
      "type": "control_block",
      "flow": ["expression"],
      "description": "Closes a loop block with exit condition",
      "syntax": "<until condition>",
      "notes": "Loop continues until this condition evaluates to true."
    },
    "while": {
      "type": "control_block",
      "flow": ["expression", "script", "endwhile"],
      "description": "While loop - repeats while condition is true",
      "syntax": "<while condition>\n  script...\n<endwhile condition>",
      "examples": [
        "<while $retry_count lt 5>\n  command retry\n  <intchange $retry_count + 1>\n<endwhile $retry_count eq 5>"
      ],
      "notes": "Executes body while condition is true. Must be closed with <endwhile>."
    },
    "endwhile": {
      "type": "control_block",
      "flow": ["expression"],
      "description": "Closes a while loop block",
      "syntax": "<endwhile condition>",
      "notes": "While loop continues until this condition evaluates to false."
    },
    "intchange": {
      "type": "control_block",
      "flow": ["expression"],
      "description": "Modify integer variable using arithmetic expression",
      "syntax": "<intchange $variable_name operator value>",
      "examples": [
        "<intchange $count + 1>",
        "<intchange $index - 10>",
        "<intchange $total * 2>"
      ],
      "notes": "Supports operators: + (add), - (subtract), * (multiply), / (divide). The first token must be a variable."
    },
    "strset": {
      "type": "parse",
      "rules": [
        ["identifier", null],
        [["identifier", "number", "string"], null]
      ],
      "description": "Set a string variable to a value",
      "syntax": "<strset variable_name value>",
      "examples": [
        "<strset PLATFORM_TYPE FortiGate-100E>",
        "<strset BUILD_NUMBER 12345>",
        "<strset STATUS none>"
      ],
      "notes": "Value can be a string, number, or identifier. Variable name should not include $ prefix."
    },
    "intset": {
      "type": "parse",
      "rules": [
        ["identifier", null],
        [["identifier", "number"], null]
      ],
      "description": "Set an integer variable to a numeric value",
      "syntax": "<intset variable_name number>",
      "examples": [
        "<intset RETRY_COUNT 5>",
        "<intset MAX_WAIT 300>",
        "<intset PORT 8080>"
      ],
      "notes": "Value must be a number or numeric identifier. Variable name should not include $ prefix."
    },
    "listset": {
      "type": "parse",
      "rules": [
        ["identifier", null],
        [["identifier", "number"], null]
      ],
      "description": "Set a list variable to a value",
      "syntax": "<listset variable_name value>",
      "examples": [
        "<listset PORTS 80,443,8080>",
        "<listset DEVICES FGT1,FGT2,FGT3>",
        "<listset IPS 192.168.1.1,192.168.1.2>"
      ],
      "notes": "Value can be comma-separated items or a single value. Variable name should not include $ prefix."
    }
  },
  "complex_examples": {
    "loop_with_counter": {
      "title": "Loop with counter variable to configure multiple items",
      "description": "This pattern shows how to use intset, while, if, and intchange together to iterate and configure multiple wireless VAPs dynamically based on a count variable.",
      "use_case": "Configure multiple wireless Virtual Access Points (VAPs) in a loop",
      "code": [
        "<intset i 1>",
        "<while>",
        "    <if $VAP_TUN_COUNT < 1>",
        "    <else>",
        "        edit \"wifi{$i}\"",
        "            set vdom FGT_FAP:VDOM1",
        "            set ssid wifi{$i}",
        "            set schedule vap-schedule",
        "            set passphrase FGT_FAP:VAPPASSWD",
        "        next",
        "    <fi>",
        "    <intchange i + 1>",
        "<endwhile {$i} > {$VAP_TUN_COUNT}>"
      ],
      "explanation": [
        "1. <intset i 1> - Initialize counter variable 'i' to 1",
        "2. <while> - Start while loop (condition checked at endwhile)",
        "3. <if $VAP_TUN_COUNT < 1> - Skip if count is less than 1",
        "4. <else> - Execute config commands if count >= 1",
        "5. Device config commands using {$i} variable interpolation",
        "6. <intchange i + 1> - Increment counter by 1",
        "7. <endwhile {$i} > {$VAP_TUN_COUNT}> - Continue loop until i exceeds count"
      ],
      "key_concepts": [
        "Variable interpolation in strings: wifi{$i} becomes wifi1, wifi2, etc.",
        "Comparison operators: < (less than), > (greater than)",
        "Loop counter pattern: initialize, use, increment, check condition",
        "Nested control structures: if/else inside while loop"
      ]
    },
    "conditional_configuration": {
      "title": "Conditional platform-specific configuration",
      "description": "Using strset and if/elseif/else to handle different device configurations",
      "use_case": "Configure different settings based on platform type",
      "code": [
        "<strset PLATFORM_TYPE none>",
        "get sys status",
        "setvar -e \"(?n)^Version: (.*?) v\" -to PLATFORM_TYPE",
        "",
        "<if $PLATFORM_TYPE eq FortiGate-100E>",
        "    config system interface",
        "        edit lan",
        "            set role undefined",
        "        next",
        "    end",
        "<elseif $PLATFORM_TYPE eq FortiGate-200F>",
        "    config system interface",
        "        edit fortilink",
        "            unset member",
        "        next",
        "    end",
        "<else>",
        "    comment: Platform not recognized",
        "<fi>"
      ],
      "explanation": [
        "1. <strset PLATFORM_TYPE none> - Initialize with default value",
        "2. Get device info and extract platform type using setvar",
        "3. <if> checks if platform matches FortiGate-100E",
        "4. <elseif> provides alternative configuration for FortiGate-200F",
        "5. <else> handles any other/unknown platforms",
        "6. <fi> closes the conditional block"
      ],
      "key_concepts": [
        "Variable initialization with default values",
        "Dynamic value extraction from command output",
        "Multiple conditional branches with elseif",
        "Platform-specific configuration patterns"
      ]
    }
  }
}
