<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title id="head-title">test_report.html</title>
      <style type="text/css">body {
  font-family: Helvetica, Arial, sans-serif;
  font-size: 12px;
  /* do not increase min-width as some may use split screens */
  min-width: 800px;
  color: #999;
}

h1 {
  font-size: 24px;
  color: black;
}

h2 {
  font-size: 16px;
  color: black;
}

p {
  color: black;
}

a {
  color: #999;
}

table {
  border-collapse: collapse;
}

/******************************
 * SUMMARY INFORMATION
 ******************************/
#environment td {
  padding: 5px;
  border: 1px solid #e6e6e6;
  vertical-align: top;
}
#environment tr:nth-child(odd) {
  background-color: #f6f6f6;
}
#environment ul {
  margin: 0;
  padding: 0 20px;
}

/******************************
 * TEST RESULT COLORS
 ******************************/
span.passed,
.passed .col-result {
  color: green;
}

span.skipped,
span.xfailed,
span.rerun,
.skipped .col-result,
.xfailed .col-result,
.rerun .col-result {
  color: orange;
}

span.error,
span.failed,
span.xpassed,
.error .col-result,
.failed .col-result,
.xpassed .col-result {
  color: red;
}

.col-links__extra {
  margin-right: 3px;
}

/******************************
 * RESULTS TABLE
 *
 * 1. Table Layout
 * 2. Extra
 * 3. Sorting items
 *
 ******************************/
/*------------------
 * 1. Table Layout
 *------------------*/
#results-table {
  border: 1px solid #e6e6e6;
  color: #999;
  font-size: 12px;
  width: 100%;
}
#results-table th,
#results-table td {
  padding: 5px;
  border: 1px solid #e6e6e6;
  text-align: left;
}
#results-table th {
  font-weight: bold;
}

/*------------------
 * 2. Extra
 *------------------*/
.logwrapper {
  max-height: 230px;
  overflow-y: scroll;
  background-color: #e6e6e6;
}
.logwrapper.expanded {
  max-height: none;
}
.logwrapper.expanded .logexpander:after {
  content: "collapse [-]";
}
.logwrapper .logexpander {
  z-index: 1;
  position: sticky;
  top: 10px;
  width: max-content;
  border: 1px solid;
  border-radius: 3px;
  padding: 5px 7px;
  margin: 10px 0 10px calc(100% - 80px);
  cursor: pointer;
  background-color: #e6e6e6;
}
.logwrapper .logexpander:after {
  content: "expand [+]";
}
.logwrapper .logexpander:hover {
  color: #000;
  border-color: #000;
}
.logwrapper .log {
  min-height: 40px;
  position: relative;
  top: -50px;
  height: calc(100% + 50px);
  border: 1px solid #e6e6e6;
  color: black;
  display: block;
  font-family: "Courier New", Courier, monospace;
  padding: 5px;
  padding-right: 80px;
  white-space: pre-wrap;
}

div.media {
  border: 1px solid #e6e6e6;
  float: right;
  height: 240px;
  margin: 0 5px;
  overflow: hidden;
  width: 320px;
}

.media-container {
  display: grid;
  grid-template-columns: 25px auto 25px;
  align-items: center;
  flex: 1 1;
  overflow: hidden;
  height: 200px;
}

.media-container--fullscreen {
  grid-template-columns: 0px auto 0px;
}

.media-container__nav--right,
.media-container__nav--left {
  text-align: center;
  cursor: pointer;
}

.media-container__viewport {
  cursor: pointer;
  text-align: center;
  height: inherit;
}
.media-container__viewport img,
.media-container__viewport video {
  object-fit: cover;
  width: 100%;
  max-height: 100%;
}

.media__name,
.media__counter {
  display: flex;
  flex-direction: row;
  justify-content: space-around;
  flex: 0 0 25px;
  align-items: center;
}

.collapsible td:not(.col-links) {
  cursor: pointer;
}
.collapsible td:not(.col-links):hover::after {
  color: #bbb;
  font-style: italic;
  cursor: pointer;
}

.col-result {
  width: 130px;
}
.col-result:hover::after {
  content: " (hide details)";
}

.col-result.collapsed:hover::after {
  content: " (show details)";
}

#environment-header h2:hover::after {
  content: " (hide details)";
  color: #bbb;
  font-style: italic;
  cursor: pointer;
  font-size: 12px;
}

#environment-header.collapsed h2:hover::after {
  content: " (show details)";
  color: #bbb;
  font-style: italic;
  cursor: pointer;
  font-size: 12px;
}

/*------------------
 * 3. Sorting items
 *------------------*/
.sortable {
  cursor: pointer;
}
.sortable.desc:after {
  content: " ";
  position: relative;
  left: 5px;
  bottom: -12.5px;
  border: 10px solid #4caf50;
  border-bottom: 0;
  border-left-color: transparent;
  border-right-color: transparent;
}
.sortable.asc:after {
  content: " ";
  position: relative;
  left: 5px;
  bottom: 12.5px;
  border: 10px solid #4caf50;
  border-top: 0;
  border-left-color: transparent;
  border-right-color: transparent;
}

.hidden, .summary__reload__button.hidden {
  display: none;
}

.summary__data {
  flex: 0 0 550px;
}
.summary__reload {
  flex: 1 1;
  display: flex;
  justify-content: center;
}
.summary__reload__button {
  flex: 0 0 300px;
  display: flex;
  color: white;
  font-weight: bold;
  background-color: #4caf50;
  text-align: center;
  justify-content: center;
  align-items: center;
  border-radius: 3px;
  cursor: pointer;
}
.summary__reload__button:hover {
  background-color: #46a049;
}
.summary__spacer {
  flex: 0 0 550px;
}

.controls {
  display: flex;
  justify-content: space-between;
}

.filters,
.collapse {
  display: flex;
  align-items: center;
}
.filters button,
.collapse button {
  color: #999;
  border: none;
  background: none;
  cursor: pointer;
  text-decoration: underline;
}
.filters button:hover,
.collapse button:hover {
  color: #ccc;
}

.filter__label {
  margin-right: 10px;
}

      </style>
    
  </head>
  <body>
    <h1 id="title">test_report.html</h1>
    <p>Report generated on 25-Feb-2026 at 19:24:19 by <a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a>
        v4.2.0</p>
    <div id="environment-header">
      <h2>Environment</h2>
    </div>
    <table id="environment"></table>
    <!-- TEMPLATES -->
      <template id="template_environment_row">
      <tr>
        <td></td>
        <td></td>
      </tr>
    </template>
    <template id="template_results-table__body--empty">
      <tbody class="results-table-row">
        <tr id="not-found-message">
          <td colspan="4">No results found. Check the filters.</td>
        </tr>
      </tbody>
    </template>
    <template id="template_results-table__tbody">
      <tbody class="results-table-row">
        <tr class="collapsible">
        </tr>
        <tr class="extras-row">
          <td class="extra" colspan="4">
            <div class="extraHTML"></div>
            <div class="media">
              <div class="media-container">
                  <div class="media-container__nav--left">&lt;</div>
                  <div class="media-container__viewport">
                    <img src="" />
                    <video controls>
                      <source src="" type="video/mp4">
                    </video>
                  </div>
                  <div class="media-container__nav--right">&gt;</div>
                </div>
                <div class="media__name"></div>
                <div class="media__counter"></div>
            </div>
            <div class="logwrapper">
              <div class="logexpander"></div>
              <div class="log"></div>
            </div>
          </td>
        </tr>
      </tbody>
    </template>
    <!-- END TEMPLATES -->
    <div class="summary">
      <div class="summary__data">
        <h2>Summary</h2>
        <div class="additional-summary prefix">
        </div>
        <p class="run-count">67 tests took 00:00:02.</p>
        <p class="filter">(Un)check the boxes to filter the results.</p>
        <div class="summary__reload">
          <div class="summary__reload__button hidden" onclick="location.reload()">
            <div>There are still tests running. <br />Reload this page to get the latest results!</div>
          </div>
        </div>
        <div class="summary__spacer"></div>
        <div class="controls">
          <div class="filters">
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="failed" disabled>
            <span class="failed">0 Failed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="passed" >
            <span class="passed">67 Passed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="skipped" disabled>
            <span class="skipped">0 Skipped,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xfailed" disabled>
            <span class="xfailed">0 Expected failures,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xpassed" disabled>
            <span class="xpassed">0 Unexpected passes,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="error" disabled>
            <span class="error">0 Errors,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="rerun" disabled>
            <span class="rerun">0 Reruns</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="retried" disabled>
            <span class="retried">0 Retried,</span>
          </div>
          <div class="collapse">
            <button id="show_all_details">Show all details</button>&nbsp;/&nbsp;<button id="hide_all_details">Hide all details</button>
          </div>
        </div>
      </div>
      <div class="additional-summary summary">
      </div>
      <div class="additional-summary postfix">
      </div>
    </div>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable" data-column-type="result">Result</th>
          <th class="sortable" data-column-type="testId">Test</th>
          <th class="sortable" data-column-type="duration">Duration</th>
          <th>Links</th>
        </tr>
      </thead>
    </table>
  <footer>
    <div id="data-container" data-jsonblob="{&#34;environment&#34;: {&#34;Python&#34;: &#34;3.12.3&#34;, &#34;Platform&#34;: &#34;Linux-6.8.0-90-generic-x86_64-with-glibc2.39&#34;, &#34;Packages&#34;: {&#34;pytest&#34;: &#34;9.0.2&#34;, &#34;pluggy&#34;: &#34;1.6.0&#34;}, &#34;Plugins&#34;: {&#34;html&#34;: &#34;4.2.0&#34;, &#34;metadata&#34;: &#34;3.1.1&#34;, &#34;mock&#34;: &#34;3.15.1&#34;, &#34;cov&#34;: &#34;7.0.0&#34;}}, &#34;tests&#34;: {&#34;testcases/test__205814.py::test__205814&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__205814.py::test__205814&#34;, &#34;duration&#34;: &#34;637 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__205814.py::test__205814&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;637 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:18 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] User API directory not found: /home/fosqa/autolibv3/autolib_v3/prototype/output/plugins/apis\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [ WARNING] [fluent] Variable not found: REGR_IPS_02_03:Busy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_02_03:Busy: create custom signatures\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    edit &amp;quot;match small&amp;quot;\n    set signature &amp;quot;F-SBID( --name &amp;quot;match small&amp;quot;; --attack_id 5835; --protocol tcp; --severity medium; --status disable; --default_action clear_session; --service http;  --pattern &amp;quot;small&amp;quot;; )&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: match small\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show ips custom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    delete &amp;quot;match small&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show ips custom\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205814) *\nRule: &amp;#x27;match small&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: True\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 205814\n\n&#34;}], &#34;testcases/test__205817.py::test__205817&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__205817.py::test__205817&#34;, &#34;duration&#34;: &#34;5 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__205817.py::test__205817&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;5 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [ WARNING] [fluent] Variable not found: REGR_IPS_02_04:Busy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_02_04:Busy: create custom signatures\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-temp&amp;quot;\n    set comment &amp;quot;temp sensor for testing&amp;quot;\n    config entries\n    edit &amp;quot;1&amp;quot;\n    set severity critical\n    set protocol TCP\n    set os Windows\n    set status enable\n    set log enable\n    set action reset\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show ips sensor sensor-temp\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205817) *\nRule: &amp;#x27;os Windows&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    delete &amp;quot;sensor-temp&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show ips sensor\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 205817\n\n&#34;}], &#34;testcases/test__735500.py::test__735500&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__735500.py::test__735500&#34;, &#34;duration&#34;: &#34;10 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__735500.py::test__735500&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;10 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Enable an IPS sensor on firewall policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ips-sensor &amp;quot;g-default&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Set database to regular\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set database regular\n    set engine-count 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    show full\n        \n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(735500) *\nRule: &amp;#x27;set database regular&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 60\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 25 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 26\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 10 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia test application ipsmonitor 1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(735500) *\nRule: &amp;#x27;database:(.*?)ipsdb&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 0\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Set database to extended\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set database extended\n    set engine-count 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    show full\n        \n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(735500) *\nRule: &amp;#x27;set database extended&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 60\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 25 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 26\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 10 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia test application ipsmonitor 1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(735500) *\nRule: &amp;#x27;database:(.*?)ipsetdb&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Remove IPS sensor from firewall policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 0\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 60\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia test application ipsmonitor 1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(735500) *\nRule: &amp;#x27;engine count =  1|engine count = 0(.*?)+1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 735500\n\n&#34;}], &#34;testcases/test__206005.py::test__206005&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__206005.py::test__206005&#34;, &#34;duration&#34;: &#34;5 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__206005.py::test__206005&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;5 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_17_10 Busy: create custom signatures match_small\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    edit &amp;quot;match small&amp;quot;\n    set signature &amp;quot;F-SBID( --name &amp;quot;match small&amp;quot;; --attack_id 5835; --protocol tcp; --severity medium; --status disable; --default_action clear_session; --service http;  --pattern &amp;quot;small&amp;quot;; )&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: match small\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe backup ipsuserdefsig ftp custom1on501e 172.16.200.55 fosqa Qa123456!\n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Backed up to ftp\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206005) *\nRule: &amp;#x27;OK&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: more /home/fosqa/custom1on501e\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206005) *\nRule: &amp;#x27;5835&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: rm -f /home/fosqa/custom1on501e\n2026-02-25 19:24:19 [    INFO] [mock_device] [PC_05] Deleted file: custom1on501e\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    delete &amp;quot;match small&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206005\n\n&#34;}], &#34;testcases/test__205961.py::test__205961&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__205961.py::test__205961&#34;, &#34;duration&#34;: &#34;8 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__205961.py::test__205961&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;8 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 12880\n    set status enable\n    set rule 12880\n    set action block\n    set log enable\n    config exempt-ip\n    edit 1\n    set dst-ip 172.16.200.55 255.255.255.255\n    set src-ip 10.1.100.22 255.255.255.255\n    next\n    edit 2\n    set dst-ip 10.1.100.22 255.255.255.255\n    set src-ip 172.16.200.55 255.255.255.255\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 10 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -s 45000 -c 10 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205961) *\nRule: &amp;#x27;45008 bytes&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -s 45000 -c 3 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205961) *\nRule: &amp;#x27;0 received|0 packets received&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205961) *\nRule: &amp;#x27;dropped(.*?)ICMP.Oversized.Packet&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    edit 2\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    delete 12880\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 205961\n\n&#34;}], &#34;testcases/test__205972.py::test__205972&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__205972.py::test__205972&#34;, &#34;duration&#34;: &#34;10 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__205972.py::test__205972&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;10 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Configure IPS sensor with two filters including all icmp based signatures\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set protocol ICMP\n    set status enable\n    set action pass\n    set log enable\n    next\n    edit 2\n    set protocol ICMP\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 10 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 10 -s 45000 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205972) *\nRule: &amp;#x27;45008 bytes&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205972) *\nRule: &amp;#x27;detected(.*?)ICMP.Oversized.Packet&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Delete the 1st filter in ips sensor\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    delete 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 5 -s 45000 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205972) *\nRule: &amp;#x27;0 received|0 packets received&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205972) *\nRule: &amp;#x27;dropped(.*?)ICMP.Oversized.Packet&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clean up environment\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    delete &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 205972\n\n&#34;}], &#34;testcases/test__797094.py::test__797094&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__797094.py::test__797094&#34;, &#34;duration&#34;: &#34;9 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__797094.py::test__797094&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;9 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Config IPS sensor and enable DSRI in firewall policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set dsri enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 --delete-after http://172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 --delete-after http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(797094) *\nRule: &amp;#x27;68/68&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set dsri disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 --delete-after http://172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 --delete-after http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(797094) *\nRule: &amp;#x27;Connection timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(797094) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clear environment\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    delete &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 797094\n\n&#34;}], &#34;testcases/test__205996.py::test__205996&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__205996.py::test__205996&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__205996.py::test__205996&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [ WARNING] [fluent] Variable not found: REGR_IPS_17_01:Busy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_17_01:Busy: create custom signatures match_apache\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    purge\n    edit small\n    set signature &amp;quot;F-SBID( --name &amp;quot;small&amp;quot;; --attack_id 5835; --protocol tcp; --severity medium; --status disable; --service http; --pattern &amp;quot;small&amp;quot;; )&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: small\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 5835\n    set rule 5835\n    set action block\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after 172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after 172.16.200.55/ips_data/text\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205996) *\nRule: &amp;#x27;timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205996) *\nRule: &amp;#x27;dropped&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    delete 5835\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 205996\n\n&#34;}], &#34;testcases/test__741441.py::test__741441&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__741441.py::test__741441&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__741441.py::test__741441&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [ WARNING] [fluent] Variable not found: REGR_IPS_17_01:Busy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_17_01:Busy: create custom signatures match_apache\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    edit &amp;quot;test&amp;quot;\n    set application DB2\n    set comment &amp;#x27;&amp;#x27;\n    set location server\n    set os Windows\n    set protocol IMAP\n    set severity high\n    set signature &amp;quot;F-SBID( --name &amp;quot;test&amp;quot;; --attack_id 6406; --severity low; --protocol tcp; --pattern &amp;quot;ABCDEFG&amp;quot;;)&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: test\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show ips custom test\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(741441) *\nRule: &amp;#x27;signature(.*?)high(.*?)server(.*?)Windows(.*?)DB2(.*?)IMAP&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    del test\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 741441\n\n&#34;}], &#34;testcases/test__206058.py::test__206058&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__206058.py::test__206058&#34;, &#34;duration&#34;: &#34;9 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__206058.py::test__206058&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;9 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_24.3:Busy: enable large_icmp signature with action pass\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    edit &amp;quot;111&amp;quot;\n    set status enable\n    set log enable\n    set action block\n    set quarantine attacker\n    set quarantine-expiry 3m\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -s 45000 -c 5 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206058) *\nRule: &amp;#x27;dropped(.*?)ICMP.Oversized.Packet&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip list\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206058) *\nRule: &amp;#x27;PC_02:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 1 172.16.200.55\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206058) *\nRule: &amp;#x27;0 received|0 packets received&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 3 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206058) *\nRule: &amp;#x27;64 bytes&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    delete &amp;quot;111&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206058\n\n&#34;}], &#34;testcases/test__801906.py::test__801906&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__801906.py::test__801906&#34;, &#34;duration&#34;: &#34;6 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__801906.py::test__801906&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;6 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Configure quarantine expire time for ips-sensor\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 12880\n    set status enable\n    set action block\n    set quarantine attacker\n    set quarantine-expiry 1d45m\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show ips sensor sensor-1\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(801906) *\nRule: &amp;#x27;set quarantine-expiry 1d45m&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Delete IPS sensor\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    delete &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Configre qurantine expire time for DoS-policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall DoS-policy\n    edit 1\n    set interface &amp;quot;port2&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    config anomaly\n    edit &amp;quot;tcp_syn_flood&amp;quot;\n    set status enable\n    set log enable\n    set action block\n    set quarantine attacker\n    set quarantine-expiry 7d12h50m\n    set quarantine-log disable\n    set threshold 100\n    next\n    edit &amp;quot;tcp_port_scan&amp;quot;\n    set threshold 1000\n    next\n    edit &amp;quot;tcp_src_session&amp;quot;\n    set threshold 5000\n    next\n    edit &amp;quot;tcp_dst_session&amp;quot;\n    set threshold 5000\n    next\n    edit &amp;quot;udp_flood&amp;quot;\n    set threshold 2000\n    next\n    edit &amp;quot;udp_scan&amp;quot;\n    set threshold 2000\n    next\n    edit &amp;quot;udp_src_session&amp;quot;\n    set threshold 5000\n    next\n    edit &amp;quot;udp_dst_session&amp;quot;\n    set threshold 5000\n    next\n    edit &amp;quot;icmp_flood&amp;quot;\n    set threshold 250\n    next\n    edit &amp;quot;icmp_sweep&amp;quot;\n    set threshold 100\n    next\n    edit &amp;quot;icmp_src_session&amp;quot;\n    set threshold 300\n    next\n    edit &amp;quot;icmp_dst_session&amp;quot;\n    set threshold 1000\n    next\n    edit &amp;quot;ip_src_session&amp;quot;\n    set threshold 100\n    next\n    edit &amp;quot;ip_dst_session&amp;quot;\n    set threshold 5000\n    next\n    edit &amp;quot;sctp_flood&amp;quot;\n    set threshold 2000\n    next\n    edit &amp;quot;sctp_scan&amp;quot;\n    set threshold 1000\n    next\n    edit &amp;quot;sctp_src_session&amp;quot;\n    set threshold 5000\n    next\n    edit &amp;quot;sctp_dst_session&amp;quot;\n    set threshold 5000\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show firewall DoS-policy 1\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(801906) *\nRule: &amp;#x27;set quarantine attacker&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(801906) *\nRule: &amp;#x27;set quarantine-expiry 7d12h50m&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Delete DoS-policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall DoS-policy\n    delete 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 801906\n\n&#34;}], &#34;testcases/test__206075.py::test__206075&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__206075.py::test__206075&#34;, &#34;duration&#34;: &#34;8 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__206075.py::test__206075&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;8 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_24.20:Busy: enable DoS sensor\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall DoS-policy\n    edit &amp;quot;111&amp;quot;\n    set interface port2\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    config anomaly\n    edit &amp;quot;icmp_flood&amp;quot;\n    set status enable\n    set log enable\n    set action block\n    set quarantine attacker\n    set quarantine-expiry 3m\n    set threshold 10\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 7\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -f -c 100 172.16.200.55\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206075) *\nRule: &amp;#x27;10 received|10 packets received&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 7\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206075) *\nRule: &amp;#x27;clear_session(.*?)anomaly: icmp_flood, 11 &amp;gt; threshold 10&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206075) *\nRule: &amp;#x27;PC_02:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 1 172.16.200.55\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206075) *\nRule: &amp;#x27;0 received|0 packets received&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 3 172.16.200.55\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206075) *\nRule: &amp;#x27;64 bytes&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall DoS-policy\n    delete 111\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206075\n\n&#34;}], &#34;testcases/test__205962.py::test__205962&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__205962.py::test__205962&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__205962.py::test__205962&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_21.8:Busy: enable interface-policy6 on incoming interface\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    set log-packet enable\n    set rule 29844\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips raw clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after 172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20  http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205962) *\nRule: &amp;#x27;Connection timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205962) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: setvar -e &amp;quot;incidentserialno=(.*?) msg&amp;quot; -to SRNO\n2026-02-25 19:24:19 [ WARNING] [fluent] setvar: Pattern &amp;#x27;incidentserialno=(.*?) msg&amp;#x27; not found in output\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: fnsysctl ls -l  /var/log/log/vd1/pcap\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: varexpect -v &amp;quot;None&amp;quot; -for 205962 -t 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    unset ips-sensor\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 205962\n\n&#34;}], &#34;testcases/test__744714.py::test__744714&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__744714.py::test__744714&#34;, &#34;duration&#34;: &#34;11 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__744714.py::test__744714&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;11 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_19.1:Busy: enable large_icmp signature with action pass\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    edit 12705\n    set status enable\n    set rule 12705\n    set action pass\n    set log enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy\n    edit 1\n    set interface port2\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set ips-sensor-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 3 172.16.200.55 -R\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(744714) *\nRule: &amp;#x27;0 received|0 packets received&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(744714) *\nRule: &amp;#x27;detected(.*?)IP.Record.Route.Option&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_019.1:Busy: enable large_icmp signature with action block\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 12705\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 3 172.16.200.55 -R\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(744714) *\nRule: &amp;#x27;dropped(.*?)IP.Record.Route.Option&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy\n    delete 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    delete 12705\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 744714\n\n&#34;}], &#34;testcases/test__711511.py::test__711511&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__711511.py::test__711511&#34;, &#34;duration&#34;: &#34;10 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__711511.py::test__711511&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;10 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_10.2:Busy: enable Winnuke.Windows.Out.Of.Band.Dos signature with action pass\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 29844\n    set status enable\n    set rule 29844\n    set rate-count 3\n    set rate-duration 60\n    set rate-track src-ip\n    set action block\n    set log enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    edit 2\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips share clear track_src_IP\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: route delete -net 172.16.200.0/24 gateway 10.10.10.1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 25 http://172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(711511) *\nRule: &amp;#x27;100%&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(711511) *\nRule: &amp;#x27;100%&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(711511) *\nRule: &amp;#x27;Connection timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(711511) *\nRule: &amp;#x27;signature(.*?)dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    edit 2\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    delete 29844\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 711511\n\n&#34;}], &#34;testcases/test__729742.py::test__729742&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__729742.py::test__729742&#34;, &#34;duration&#34;: &#34;8 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__729742.py::test__729742&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;8 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_21.8:Busy: enable interface-policy6 on incoming interface\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    set log-packet enable\n    set rule 29844\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips raw clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 30 https://172.16.200.55/index.html --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 32\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -4kv -m 30 https://172.16.200.55/virus/eicar -O\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 32\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729742) *\nRule: &amp;#x27;Operation timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729742) *\nRule: &amp;#x27;dropped(.*?)dstport=443(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: setvar -e &amp;quot;incidentserialno=(.*?) msg&amp;quot; -to SRNO\n2026-02-25 19:24:19 [ WARNING] [fluent] setvar: Pattern &amp;#x27;incidentserialno=(.*?) msg&amp;#x27; not found in output\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: fnsysctl ls -l  /var/log/log/vd1/pcap\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: varexpect -v &amp;quot;None&amp;quot; -for 729742 -t 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    unset ips-sensor\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 729742\n\n&#34;}], &#34;testcases/test__729743.py::test__729743&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__729743.py::test__729743&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__729743.py::test__729743&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_21.8:Busy: enable interface-policy6 on incoming interface\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action block\n    set log-packet enable\n    set quarantine attacker\n    set quarantine-expiry 2m\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 https://172.16.200.55 --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -4kv -m 15 https://172.16.200.55/virus/eicar -O\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729743) *\nRule: &amp;#x27;Operation timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729743) *\nRule: &amp;#x27;dropped(.*?)dstport=443(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729743) *\nRule: &amp;#x27;PC_05:IP_ETH1 (.*?)IPS&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 130\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    unset ips-sensor\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 729743\n\n&#34;}], &#34;testcases/test__751046.py::test__751046&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__751046.py::test__751046&#34;, &#34;duration&#34;: &#34;9 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__751046.py::test__751046&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;9 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Enable custom sig match small and Eicar on IPS sensor\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    edit &amp;quot;match small&amp;quot;\n    set signature &amp;quot;F-SBID( --name &amp;quot;match small&amp;quot;; --attack_id 5835; --protocol tcp; --severity medium; --status disable; --default_action clear_session; --service http;  --pattern &amp;quot;small&amp;quot;; )&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: match small\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    set log-packet enable\n    set rule 5835 29844\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips raw clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 https://172.16.200.55/index.html --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk -m 20 https://172.16.200.55/ips_data/text\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751046) *\nRule: &amp;#x27;timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk -m 20 https://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751046) *\nRule: &amp;#x27;timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 4\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751046) *\nRule: &amp;#x27;dropped(.*?)dstport=443(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751046) *\nRule: &amp;#x27;dropped(.*?)dstport=443(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)match small&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clean up environment\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 751046\n\n&#34;}], &#34;testcases/test__751047.py::test__751047&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__751047.py::test__751047&#34;, &#34;duration&#34;: &#34;17 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__751047.py::test__751047&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;17 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment enable flow av/dlp/webfilter on firewall policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config webfilter profile\n    edit &amp;quot;web-filter-flow&amp;quot;\n    config ftgd-wf\n    config filters\n    edit 25\n    set category 25\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config webfilter urlfilter\n    edit 1\n    config entries\n    edit 3\n    set url &amp;quot;www.facebook.com&amp;quot;\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set utm-status enable\n    set av-profile &amp;quot;AV-flow&amp;quot;\n    set webfilter-profile &amp;quot;web-filter-flow&amp;quot;\n    set dlp-profile &amp;quot;flow-dlp&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips raw clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia test application urlfilter 99\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 -S https://172.16.200.55/virus/eicar --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;Connection reset by peer&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 2\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;blocked(.*?)EICAR_TEST_FILE(.*?)AV-flow&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log filter field subtype forward\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;block(.*?)countav=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log delete\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 18 -S https://172.16.200.55/app_data/bar.exe --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;Connection reset by peer|Connection timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 9\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;block(.*?)bar.exe(.*?)flow-dlp&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log filter field subtype forward\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;block(.*?)countdlp=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log delete\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v -k -4 https://172.16.200.55 -m 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v -k -4  https://www.youtube.com -m 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;Web Page Blocked|OpenSSL SSL_read: SSL_ERROR_SYSCALL|SSL_write(.*?)errno&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v -k -4  https://www.facebook.com -m 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;Web Page Blocked&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session filter src 10.1.100.22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;urlfilter(.*?)web-filter-flow(.*?)www.facebook.com(.*?)blocked&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;ftgd_blk(.*?)www.youtube.com(.*?)web-filter-flow(.*?)blocked(.*?)Streaming Media and Download&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log filter field subtype forward\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;block(.*?)countweb&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(751047) *\nRule: &amp;#x27;block(.*?)countweb&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    set nat disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config webfilter urlfilter\n    edit 1\n    config entries\n    delete 3\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config webfilter profile\n    edit &amp;quot;web-filter-flow&amp;quot;\n    config ftgd-wf\n    config filters\n    delete 25\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 751047\n\n&#34;}], &#34;testcases/test__796399.py::test__796399&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__796399.py::test__796399&#34;, &#34;duration&#34;: &#34;6 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__796399.py::test__796399&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;6 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall decrypted-traffic-mirror\n    edit &amp;quot;ssl-mirror&amp;quot;\n    set traffic-type ssl\n    set traffic-source client\n    set interface PORT4\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    myset decrypted-traffic-mirror ssl-mirror\n        \n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796399) *\nRule: &amp;#x27;THIS IS A LEGALLY BINDING AGREEMENT&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796399) *\nRule: &amp;#x27;Do you want to continue&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: y\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show firewall policy 1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796399) *\nRule: &amp;#x27;set decrypted-traffic-mirror \\&amp;quot;ssl-mirror\\&amp;quot;&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    unset decrypted-traffic-mirror\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall decrypted-traffic-mirror\n    del &amp;quot;ssl-mirror&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 796399\n\n&#34;}], &#34;testcases/test__796400.py::test__796400&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__796400.py::test__796400&#34;, &#34;duration&#34;: &#34;16 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__796400.py::test__796400&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;16 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Enable ssl mirror in firewall policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config global\n    config system fortiguard\n    set protocol udp\n    set port 8888\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Edit webfilter profile to block Streaming Media and Download\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config webfilter profile\n    edit &amp;quot;web-filter-flow&amp;quot;\n    config ftgd-wf\n    config filters\n    edit 100\n    set category 25\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Create decrypted-traffic-mirror profile\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall decrypted-traffic-mirror\n    edit &amp;quot;ssl-mirror&amp;quot;\n    set traffic-type ssl\n    set traffic-source client\n    set interface PORT4\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Enable flow based dlp and flow based webfilter in firewall policy.\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set dlp-profile flow-dlp\n    set webfilter-profile web-filter-flow\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set np-acceleration disable\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set decrypted-traffic-mirror ssl-mirror\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clear sys/ips sessions and all logs on disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sniffer packet port4 &amp;#x27;port 443&amp;#x27; 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 1\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 https://172.16.200.55/index.html --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Visit youtube to trigger webfilter profile\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v -4 -k https://www.youtube.com\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796400) *\nRule: &amp;#x27;Web Page Blocked|SSL_ERROR_SYSCALL, errno 104|SYSCALL, errno = 104|SSL_read(.*?)errno&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check if ssl mirror is triggered and check webfilter log\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796400) *\nRule: &amp;#x27;PC_02:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796400) *\nRule: &amp;#x27;.443&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ctrl_c\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sniffer packet port4 &amp;#x27;port 443&amp;#x27; 4\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796400) *\nRule: &amp;#x27;web-filter-flow(.*?)blocked(.*?)Streaming Media and Download&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 https://172.16.200.55/index.html --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download an exe file to trigger dlp sensor\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 https://172.16.200.55/app_data/bar.exe --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796400) *\nRule: &amp;#x27;Connection reset by peer|Connection timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check if ssl mirror is triggered and check dlp log\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796400) *\nRule: &amp;#x27;PC_02:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796400) *\nRule: &amp;#x27;PC_05:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796400) *\nRule: &amp;#x27;.443&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ctrl_c\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 9\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796400) *\nRule: &amp;#x27;block(.*?)flow-dlp&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clean up environment\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    unset decrypted-traffic-mirror\n    set utm-status disable\n    unset np-acceleration\n    set nat disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall decrypted-traffic-mirror\n    del &amp;quot;ssl-mirror&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config webfilter profile\n    edit &amp;quot;web-filter-flow&amp;quot;\n    config ftgd-wf\n    config filters\n    delete 100\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 796400\n\n&#34;}], &#34;testcases/test__796402.py::test__796402&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__796402.py::test__796402&#34;, &#34;duration&#34;: &#34;14 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__796402.py::test__796402&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;14 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set np-accel-mode none\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Enable ssl mirror in firewall policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Create a new application list to block Video/Audio.\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    edit &amp;quot;app-list-1&amp;quot;\n    set other-application-log enable\n    config entries\n    edit 1\n    set category 5\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Create an IPS sensor to block eicar.\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Create decrypted-traffic-mirror profile\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall decrypted-traffic-mirror\n    edit &amp;quot;ssl-mirror&amp;quot;\n    set traffic-type ssl\n    set traffic-source client\n    set interface PORT4\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Enable ips sensor and application list in firewall policy.\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set application-list &amp;quot;app-list-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set np-acceleration disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set decrypted-traffic-mirror ssl-mirror\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clear sys/ips sessions and all logs on disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sniffer packet PORT4 &amp;#x27;port 443&amp;#x27; 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 1\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 https://172.16.200.55/index.html --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download story.mp3 to trigger application list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v -k https://172.16.200.55/app_data/story.mp3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02_2\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: pkill curl\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796402) *\nRule: &amp;#x27;PC_02:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796402) *\nRule: &amp;#x27;PC_05:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796402) *\nRule: &amp;#x27;.443&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ctrl_c\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sniffer packet PORT4 &amp;#x27;port 443&amp;#x27; 4\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796402) *\nRule: &amp;#x27;app-list-1(.*?)block(.*?)HTTP.Audio&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 https://172.16.200.55/index.html --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download eicar to trigger ips sensor\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk -m 15 https://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 18\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796402) *\nRule: &amp;#x27;timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796402) *\nRule: &amp;#x27;PC_02:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796402) *\nRule: &amp;#x27;PC_05:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ctrl_c\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796402) *\nRule: &amp;#x27;dropped(.*?)sensor-1(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clean up environment\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    unset decrypted-traffic-mirror\n    set utm-status disable\n    unset np-acceleration\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall decrypted-traffic-mirror\n    del &amp;quot;ssl-mirror&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    delete &amp;quot;app-list-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    unset np-accel-mode\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 796402\n\n&#34;}], &#34;testcases/test__796386.py::test__796386&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__796386.py::test__796386&#34;, &#34;duration&#34;: &#34;17 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__796386.py::test__796386&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;17 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config antivirus profile\n    edit &amp;quot;flow-av&amp;quot;\n    config http\n    set av-scan monitor\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set av-profile &amp;quot;flow-av&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips av cache clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia antivirus quarantine purge\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk https://172.16.200.55/virus/eicar -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;HTTP\\/2 200&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;EICAR-STANDARD-ANTIVIRUS-TEST-FILE&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl status\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 1\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;TLS 1.3: 1\\/1\\/0\\/0&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;HTTP\\/2:  1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 2\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;action=\\&amp;quot;monitored(.*?)service=\\&amp;quot;HTTPS(.*?)dstport=443(.*)direction=\\&amp;quot;incoming(.*?)filename=\\&amp;quot;eicar(.*?)virus=\\&amp;quot;EICAR_TEST_FILE&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;service=\\&amp;quot;HTTPS(.*?)utmaction=\\&amp;quot;allow(.*?)countav=1(.*?)utmref&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config antivirus profile\n    edit &amp;quot;flow-av&amp;quot;\n    config http\n    set av-scan block\n    set quarantine enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips av cache clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk https://172.16.200.55/virus/eicar.exe -m 15 -O\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;GET \\/virus\\/eicar.exe HTTP\\/2&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;Failed receiving HTTP2 data|Failed sending HTTP2 data&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl status\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 1\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;TLS 1.3: 1\\/1\\/0\\/0&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;HTTP\\/2:  1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia antivirus quarantine list\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;eicar&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 2\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;action=\\&amp;quot;blocked(.*?)service=\\&amp;quot;HTTPS(.*?)dstport=443(.*)direction=\\&amp;quot;incoming(.*?)virus=\\&amp;quot;EICAR_TEST_FILE&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796386) *\nRule: &amp;#x27;service=\\&amp;quot;HTTPS(.*?)utmaction=\\&amp;quot;block(.*?)countav=1(.*?)utmref&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config antivirus profile\n    del &amp;quot;flow-av&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips av cache clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia antivirus quarantine purge\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 0\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 796386\n\n&#34;}], &#34;testcases/test__796389.py::test__796389&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__796389.py::test__796389&#34;, &#34;duration&#34;: &#34;17 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__796389.py::test__796389&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;17 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    edit &amp;quot;app-list-1&amp;quot;\n    set other-application-log enable\n    config entries\n    edit 1\n    set category 2 5 6\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set application-list &amp;quot;app-list-1&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk https://172.16.200.55/app_data/story.mp3 -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;GET \\/app_data\\/story.mp3 HTTP\\/2&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;Operation timed out|Failed sending HTTP2 data&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl status\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;TLS 1.3: 1\\/1\\/0\\/0&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;HTTP\\/2:  1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter field dstip 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;dstport=443(.*)service=\\&amp;quot;HTTPS(.*?)direction=\\&amp;quot;incoming(.*?)action=\\&amp;quot;block(.*?)app=\\&amp;quot;HTTP.Audio&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;service=\\&amp;quot;HTTPS(.*?)app=\\&amp;quot;HTTP.Audio(.*?)utmaction=\\&amp;quot;block(.*?)countapp=3(.*?)utmref&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    edit &amp;quot;app-list-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk https://172.16.200.55/app_data/story.mp3 -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;HTTP\\/2 200&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;content-type: audio\\/mpeg&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl status\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;TLS 1.3: 1\\/1\\/0\\/0&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;HTTP\\/2:  1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter field dstip 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;dstport=443(.*)service=\\&amp;quot;HTTPS(.*?)direction=\\&amp;quot;incoming(.*?)action=\\&amp;quot;pass(.*?)app=\\&amp;quot;HTTP.Audio&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796389) *\nRule: &amp;#x27;service=\\&amp;quot;HTTPS(.*?)app=\\&amp;quot;HTTP.Audio(.*?)utmaction=\\&amp;quot;allow(.*?)countapp=3(.*?)utmref&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    del &amp;quot;app-list-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 0\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 796389\n\n&#34;}], &#34;testcases/test__796392.py::test__796392&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__796392.py::test__796392&#34;, &#34;duration&#34;: &#34;12 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__796392.py::test__796392&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;12 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    edit &amp;quot;match small&amp;quot;\n    set signature &amp;quot;F-SBID( --name &amp;quot;match small &amp;quot;; --attack_id 5835; --protocol tcp; --severity medium; --status disable; --default_action drop; --service http;  --pattern &amp;quot;small&amp;quot;; --context file; )&amp;quot;\n    set comment &amp;#x27;&amp;#x27;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: match small\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action pass\n    set log enable\n    next\n    edit 2\n    set rule 5835\n    set status enable\n    set action block\n    set log enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor sensor-1\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk https://172.16.200.55/virus/eicar -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796392) *\nRule: &amp;#x27;HTTP\\/2 200&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796392) *\nRule: &amp;#x27;EICAR-STANDARD-ANTIVIRUS-TEST-FILE&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk https://172.16.200.55/ips_data/text -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796392) *\nRule: &amp;#x27;SSL_write(.*?)errno|Operation timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl status\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796392) *\nRule: &amp;#x27;TLS 1.3: 2\\/2\\/0\\/0&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796392) *\nRule: &amp;#x27;HTTP\\/2:  2&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796392) *\nRule: &amp;#x27;action=\\&amp;quot;dropped(.*?)service=\\&amp;quot;HTTPS(.*?)dstport=443(.*)direction=\\&amp;quot;incoming(.*?)custom: match small&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796392) *\nRule: &amp;#x27;action=\\&amp;quot;detected(.*?)service=\\&amp;quot;HTTPS(.*?)dstport=443(.*?)direction=\\&amp;quot;incoming(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796392) *\nRule: &amp;#x27;service=\\&amp;quot;HTTPS(.*?)utmaction=\\&amp;quot;block(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(796392) *\nRule: &amp;#x27;service=\\&amp;quot;HTTPS(.*?)utmaction=\\&amp;quot;allow(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 0\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 796392\n\n&#34;}], &#34;testcases/test__850613.py::test__850613&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__850613.py::test__850613&#34;, &#34;duration&#34;: &#34;10 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__850613.py::test__850613&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;10 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action block\n    set quarantine attacker\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor sensor-1\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk https://172.16.200.55/virus/eicar -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(850613) *\nRule: &amp;#x27;GET \\/virus\\/eicar HTTP\\/2&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(850613) *\nRule: &amp;#x27;Operation timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip list\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(850613) *\nRule: &amp;#x27;PC_05:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl status\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(850613) *\nRule: &amp;#x27;TLS 1.3: 1\\/1\\/0\\/0&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(850613) *\nRule: &amp;#x27;HTTP\\/2:  1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(850613) *\nRule: &amp;#x27;action=\\&amp;quot;dropped(.*?)service=\\&amp;quot;HTTPS(.*?)dstport=443(.*?)direction=\\&amp;quot;incoming(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(850613) *\nRule: &amp;#x27;service=\\&amp;quot;HTTPS(.*?)utmaction=\\&amp;quot;block(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 0\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 850613\n\n&#34;}], &#34;testcases/test__877245.py::test__877245&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__877245.py::test__877245&#34;, &#34;duration&#34;: &#34;17 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__877245.py::test__877245&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;17 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-botnet&amp;quot;\n    set scan-botnet-connections block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-botnet&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys botnet-ip flush\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys botnet-ip list 0 50 | grep &amp;#x27;port=80-80&amp;#x27;\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: setvar -e &amp;quot;ip=(.*?)-&amp;quot; -to IPADDR\n2026-02-25 19:24:19 [ WARNING] [fluent] setvar: Pattern &amp;#x27;ip=(.*?)-&amp;#x27; not found in output\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys botnet-ip list 0 50 | grep &amp;#x27;port=80-80&amp;#x27;\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: setvar -e &amp;quot;botnet=(.*?), hit_count&amp;quot; -to RULEID\n2026-02-25 19:24:19 [ WARNING] [fluent] setvar: Pattern &amp;#x27;botnet=(.*?), hit_count&amp;#x27; not found in output\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v http://None -m 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 6\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(877245) *\nRule: &amp;#x27;Connection timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(877245) *\nRule: &amp;#x27;eventtype=\\&amp;quot;botnet(.*?)msg=\\&amp;quot;Botnet C&amp;amp;C Communication&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: varexpect -v &amp;quot;None&amp;quot; -for 877246 -t 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(877245) *\nRule: &amp;#x27;action=\\&amp;quot;dropped(.*?)service=\\&amp;quot;HTTP&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: varexpect -v &amp;quot;None&amp;quot; -for 877246 -t 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(877245) *\nRule: &amp;#x27;action=\\&amp;quot;timeout(.*?)service=\\&amp;quot;HTTP(.*?)utmaction=\\&amp;quot;block(.*?)countips=1(.*?)utmref&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-botnet&amp;quot;\n    set scan-botnet-connections monitor\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v http://None -m 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 6\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(877245) *\nRule: &amp;#x27;Operation timed out|Connection timed out|200 OK|Connection refused|404 Not Found&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(877245) *\nRule: &amp;#x27;eventtype=\\&amp;quot;botnet(.*?)msg=\\&amp;quot;Botnet C&amp;amp;C Communication&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: varexpect -v &amp;quot;None&amp;quot; -for 877246 -t 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(877245) *\nRule: &amp;#x27;action=\\&amp;quot;detected(.*?)service=\\&amp;quot;HTTP&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: varexpect -v &amp;quot;None&amp;quot; -for 877246 -t 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(877245) *\nRule: &amp;#x27;service=\\&amp;quot;HTTP(.*?)utmaction=\\&amp;quot;allow(.*?)countips=1(.*?)utmref&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys botnet-ip hit\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(877245) *\nRule: &amp;#x27;proto=TCP(.*?)ip={$IPADDR}(.*?)port=80(.*?)botnet={$RULEID}(.*?)hit_count=2&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys botnet-ip flush\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys botnet-ip hit\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(877245) *\nRule: &amp;#x27;The number of hit entries: 0&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-botnet&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 877245\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 877246\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 877247\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 877980\n\n&#34;}], &#34;testcases/test__206036.py::test__206036&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__206036.py::test__206036&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__206036.py::test__206036&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_21.1:Busy: enable interface-policy6 on incoming interface\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy6\n    edit 1\n    set interface PORT2\n    set srcaddr6 &amp;quot;all&amp;quot;\n    set dstaddr6 &amp;quot;all&amp;quot;\n    set service6 &amp;quot;ALL&amp;quot;\n    set ips-sensor-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show firewall interface-policy6\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206036) *\nRule: &amp;#x27;ips-sensor-status enable&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy6\n    delete 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206036\n\n&#34;}], &#34;testcases/test__729766.py::test__729766&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__729766.py::test__729766&#34;, &#34;duration&#34;: &#34;8 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__729766.py::test__729766&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;8 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_21.8:Busy: enable interface-policy6 on incoming interface\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    edit &amp;quot;match small&amp;quot;\n    set comment &amp;#x27;&amp;#x27;\n    set signature &amp;quot;F-SBID( --attack_id 5835;  --name &amp;quot;match small&amp;quot;; --default_action reset; --service http; --protocol tcp; --pattern &amp;quot;small&amp;quot;; --severity info; --status disable; )&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: match small\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-11&amp;quot;\n    config entries\n    purge\n    edit 1\n    set action pass\n    set log-packet enable\n    set rule 29844\n    set status enable\n    next\n    edit 2\n    set action reset\n    set log-packet enable\n    set rule 5835\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 11\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr6 &amp;quot;all&amp;quot;\n    set dstaddr6 &amp;quot;all&amp;quot;\n    set action accept\n    set utm-status enable\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set ips-sensor &amp;quot;sensor-11&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips raw clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session6 clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -6 -t 1 -T 20 -S --delete-after http://[2000:172:16:200::55]/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -6 -t 1 -T 20 -S --delete-after http://[2000:172:16:200::55]/ips_data/text\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729766) *\nRule: &amp;#x27;Connection reset by peer&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -6 -t 1 -T 20 -S --delete-after http://[2000:172:16:200::55]/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729766) *\nRule: &amp;#x27;68/68&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729766) *\nRule: &amp;#x27;detected(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729766) *\nRule: &amp;#x27;reset&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-11&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    delete 11\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 729766\n\n&#34;}], &#34;testcases/test__730347.py::test__730347&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__730347.py::test__730347&#34;, &#34;duration&#34;: &#34;11 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__730347.py::test__730347&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;11 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Configure IPS sensor and firewall policy6\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action block\n    set rate-count 3\n    set rate-duration 60\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 11\n    set srcintf port2\n    set dstintf port1\n    set srcaddr6 &amp;quot;all&amp;quot;\n    set dstaddr6 &amp;quot;all&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session6 clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping6 -c 4 2000:172:16:200::55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 --delete-after http://[2000:172:16:200::55]\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 60\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: cd /home/tester/ips/attack_scripts\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ./fork 10 3 wget -t 1 -T 20 --delete-after http://[2000:172:16:200::55]/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730347) *\nRule: &amp;#x27;68/68&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730347) *\nRule: &amp;#x27;68/68&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730347) *\nRule: &amp;#x27;dropped(.*?)attackid=29844(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 11\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 730347\n\n&#34;}], &#34;testcases/test__744756.py::test__744756&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__744756.py::test__744756&#34;, &#34;duration&#34;: &#34;10 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__744756.py::test__744756&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;10 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_21.8:Busy: enable interface-policy6 on incoming interface\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    set log-packet enable\n    set rule 29844\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 11\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr6 &amp;quot;all&amp;quot;\n    set dstaddr6 &amp;quot;all&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips raw clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session6 clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -6 -t 1 -T 15 -S --delete-after https://[2000:172:16:200::55] --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk -m 15 https://[2000:172:16:200::55]/virus/eicar -g\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(744756) *\nRule: &amp;#x27;timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(744756) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 11\n    unset ips-sensor\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 12\n    unset ips-sensor\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 744756\n\n&#34;}], &#34;testcases/test__206024.py::test__206024&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__206024.py::test__206024&#34;, &#34;duration&#34;: &#34;14 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__206024.py::test__206024&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;14 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_19.5:Busy: create custom signatures match_apache\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    edit &amp;quot;match apache&amp;quot;\n    set signature &amp;quot;F-SBID( --attack_id 5022;  --name &amp;quot;match Apache&amp;quot;; --default_action reset; --service http; --protocol tcp; --pattern &amp;quot;Apache&amp;quot;;--severity info; --status disable; )&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: match apache\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 5022\n    set rule 5022\n    set status enable\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy\n    edit 1\n    set interface &amp;quot;vlan100&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set ips-sensor-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: route add -host 172.16.200.55 gw 10.10.10.1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after http://172.16.200.55/ips_data/text\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206024) *\nRule: &amp;#x27;100%&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206024) *\nRule: &amp;#x27;detected.*attackid=5022.*custom: match Apache&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 5022\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after 172.16.200.55/ips_data/text\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206024) *\nRule: &amp;#x27;timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: route del -host 172.16.200.55 gw 10.10.10.1\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206024) *\nRule: &amp;#x27;dropped.*attackid=5022.*custom: match Apache&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy\n    delete 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    delete 5022\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    delete &amp;quot;match apache&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206024\n\n&#34;}], &#34;testcases/test__744749.py::test__744749&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__744749.py::test__744749&#34;, &#34;duration&#34;: &#34;12 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__744749.py::test__744749&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;12 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Config IPS sensor and AppCtrl list in firewall interface policy6\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    edit &amp;quot;app-list-1&amp;quot;\n    config entries\n    edit 1\n    set category 5\n    next\n    edit 2\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy6\n    edit 1\n    set interface &amp;quot;port2&amp;quot;\n    set srcaddr6 &amp;quot;all&amp;quot;\n    set dstaddr6 &amp;quot;all&amp;quot;\n    set service6 &amp;quot;ALL&amp;quot;\n    set ips-sensor-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set application-list-status enable\n    set application-list &amp;quot;app-list-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session6 clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 --delete-after http://[2000:172:16:200::55]\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 --delete-after http://[2000:172:16:200::55]/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(744749) *\nRule: &amp;#x27;Connection timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v -6 -g -m 10 http://[2000:172:16:200::55]/app_data/story.mp3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(744749) *\nRule: &amp;#x27;Application Blocked&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02_2\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: pkill curl\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(744749) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(744749) *\nRule: &amp;#x27;app-list-1(.*?)block(.*?)HTTP.Audio&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clear environment\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy6\n    delete 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    delete &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    delete &amp;quot;app-list-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 744749\n\n&#34;}], &#34;testcases/test__730261.py::test__730261&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__730261.py::test__730261&#34;, &#34;duration&#34;: &#34;20 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__730261.py::test__730261&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;20 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_21.8:Busy: enable interface-policy6 on incoming interface\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    set log-packet enable\n    set rule 29844\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config web-proxy global\n    set proxy-fqdn &amp;quot;default.fqdn&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config web-proxy explicit\n    set status enable\n    set ftp-over-http enable\n    set pac-file-server-status enable\n    set ipv6-status enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ftp-proxy explicit\n    set status enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system interface\n    edit PORT2\n    set explicit-web-proxy enable\n    set explicit-ftp-proxy enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set proxy explicit-web\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;webproxy&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v http://172.16.200.55/index.html -m 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730261) *\nRule: &amp;#x27;blocked by Intrusion Prevention|blocked by IPS Sensor&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730261) *\nRule: &amp;#x27;dropped(.*?)dstport=80(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action reset\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia wad session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: cp /root/eicar /home/fosqa/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v ftp://fosqa:&amp;quot;Qa123456!&amp;quot;@172.16.200.55/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730261) *\nRule: &amp;#x27;reset(.*?)dstport=21(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v -k https://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730261) *\nRule: &amp;#x27;HTTP/1.1 200 OK|HTTP/2 200&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730261) *\nRule: &amp;#x27;detected(.*?)dstport=443(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    del 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: rm /home/fosqa/eicar\n2026-02-25 19:24:19 [    INFO] [mock_device] [PC_05] Deleted file: eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 730261\n\n&#34;}], &#34;testcases/test__781994.py::test__781994&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__781994.py::test__781994&#34;, &#34;duration&#34;: &#34;18 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__781994.py::test__781994&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;18 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Configure IPS sensor and explicit web-proxy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action pass\n    set log enable\n    set rule 29844\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config web-proxy global\n    set proxy-fqdn &amp;quot;default.fqdn&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config web-proxy explicit\n    set status enable\n    set ipv6-status enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ftp-proxy explicit\n    set status enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system interface\n    edit PORT2\n    set explicit-web-proxy enable\n    set explicit-ftp-proxy enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set proxy explicit-web\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;webproxy&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 35\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v http://172.16.200.55 -m 18\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v -F &amp;quot;f1=@/home/tester/ips/attack_scripts/eicar.1&amp;quot; httpbin.org/post\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 18\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(781994) *\nRule: &amp;#x27; We are completely uploaded and fine&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(781994) *\nRule: &amp;#x27;detected(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v http://172.16.200.55 -m 18\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v -X PUT -F &amp;quot;f1=@/home/tester/ips/attack_scripts/eicar.1&amp;quot; httpbin.org/post\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 18\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(781994) *\nRule: &amp;#x27;Your attempt to access the Internet resource is blocked by Intrusion Prevention&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(781994) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action reset\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v http://172.16.200.55 -m 18\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v -X PUT -F &amp;quot;f1=@/home/tester/ips/attack_scripts/eicar.1&amp;quot; httpbin.org/post\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 18\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(781994) *\nRule: &amp;#x27;Your attempt to access the Internet resource is blocked by Intrusion Prevention&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(781994) *\nRule: &amp;#x27;reset(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    delete 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set nat disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 781994\n\n&#34;}], &#34;testcases/test__730265.py::test__730265&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__730265.py::test__730265&#34;, &#34;duration&#34;: &#34;11 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__730265.py::test__730265&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;11 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_21.8:Busy: enable interface-policy6 on incoming interface\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    set log-packet enable\n    set quarantine attacker\n    set quarantine-expiry 2m\n    set rule 29844\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config web-proxy global\n    set proxy-fqdn &amp;quot;default.fqdn&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config web-proxy explicit\n    set status enable\n    set ftp-over-http enable\n    set pac-file-server-status enable\n    set ipv6-status enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ftp-proxy explicit\n    set status enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system interface\n    edit PORT2\n    set explicit-web-proxy enable\n    set explicit-ftp-proxy enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set proxy explicit-web\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;webproxy&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips raw clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730265) *\nRule: &amp;#x27;dropped(.*?)dstport=80(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip list\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730265) *\nRule: &amp;#x27;PC_05:IP_ETH1 (.*?)IPS&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 130\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    del 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 730265\n\n&#34;}], &#34;testcases/test__730268.py::test__730268&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__730268.py::test__730268&#34;, &#34;duration&#34;: &#34;9 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__730268.py::test__730268&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;9 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_21.8:Busy: enable interface-policy6 on incoming interface\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    set log-packet enable\n    set rule 29844\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config web-proxy global\n    set proxy-fqdn &amp;quot;default.fqdn&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config web-proxy explicit\n    set status enable\n    set ftp-over-http enable\n    set pac-file-server-status enable\n    set ipv6-status enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ftp-proxy explicit\n    set status enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system interface\n    edit PORT2\n    set explicit-web-proxy enable\n    set explicit-ftp-proxy enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set proxy explicit-web\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set srcaddr6 &amp;quot;all&amp;quot;\n    set dstaddr6 &amp;quot;all&amp;quot;\n    set service &amp;quot;webproxy&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips raw clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -g -x [2000:10:1:100::1]:8080 -v http://[2000:172:16:200::55]/index.html -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -g -x [2000:10:1:100::1]:8080 -v http://[2000:172:16:200::55]/virus/eicar -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730268) *\nRule: &amp;#x27;blocked by Intrusion Prevention|blocked by IPS Sensor&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730268) *\nRule: &amp;#x27;dropped(.*?)dstport=80(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    del 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 730268\n\n&#34;}], &#34;testcases/test__730278.py::test__730278&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__730278.py::test__730278&#34;, &#34;duration&#34;: &#34;10 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__730278.py::test__730278&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;10 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_21.8:Busy: enable interface-policy6 on incoming interface\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    set log-packet enable\n    set rule 29844\n    set status enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config web-proxy global\n    set proxy-fqdn &amp;quot;default.fqdn&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config web-proxy explicit\n    set status enable\n    set ftp-over-http enable\n    set pac-file-server-status enable\n    set ipv6-status enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ftp-proxy explicit\n    set status enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system interface\n    edit PORT2\n    set explicit-web-proxy enable\n    set explicit-ftp-proxy enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set proxy explicit-web\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;webproxy&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips raw clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -x 10.1.100.1:8080 -v http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730278) *\nRule: &amp;#x27;blocked by Intrusion Prevention|blocked by IPS Sensor&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730278) *\nRule: &amp;#x27;dropped(.*?)dstport=80(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exec log filter field subtype forward\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(730278) *\nRule: &amp;#x27;utmref&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    del 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 730278\n\n&#34;}], &#34;testcases/test__205921.py::test__205921&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__205921.py::test__205921&#34;, &#34;duration&#34;: &#34;8 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__205921.py::test__205921&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;8 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_7.1:Busy: no sensor need to be enabled\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sniffer packet any &amp;#x27;tcp and host 10.1.100.22 and host 172.16.200.55 &amp;#x27; 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 1\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: /home/tester/ips/attack_scripts/syn_fin 10.1.100.22 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 1\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(205921) *\nRule: &amp;#x27;in PC_02:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ctrl_c\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02_2\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: killall syn_fin\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 205921\n\n&#34;}], &#34;testcases/test__206022.py::test__206022&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__206022.py::test__206022&#34;, &#34;duration&#34;: &#34;17 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__206022.py::test__206022&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;17 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy6\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall DoS-policy\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall DoS-policy6\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system zone\n    edit &amp;quot;zone1&amp;quot;\n    set intrazone deny\n    set interface &amp;quot;PORT2&amp;quot; &amp;quot;vlan100&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    edit &amp;quot;match small&amp;quot;\n    set signature &amp;quot;F-SBID( --name &amp;quot;match small&amp;quot;; --attack_id 5835; --protocol tcp; --severity medium; --status disable; --default_action &amp;quot;clear_session&amp;quot;; --service http; --pattern &amp;quot;small&amp;quot;; )&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: match small\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 29844\n    set rule 29844\n    set status enable\n    set action reset\n    set log enable\n    next\n    edit 5835\n    set rule 5835\n    set status enable\n    set action block\n    set log enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set srcintf &amp;quot;zone1&amp;quot;\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set action accept\n    set service &amp;quot;ALL&amp;quot;\n    set schedule always\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 https://172.16.200.55/index.html --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 http://172.16.200.55/virus/eicar --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206022) *\nRule: &amp;#x27;Connection reset by peer&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 http://172.16.200.55/ips_data/text --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206022) *\nRule: &amp;#x27;Connection timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206022) *\nRule: &amp;#x27;dropped(.*?)custom: match small&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206022) *\nRule: &amp;#x27;reset(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall DoS-policy\n    edit &amp;quot;111&amp;quot;\n    set interface zone1\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    config anomaly\n    edit &amp;quot;icmp_flood&amp;quot;\n    set status enable\n    set action block\n    set threshold 50\n    set log enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips anomaly clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -f -q -c 100 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206022) *\nRule: &amp;#x27;[4-5]{1}\\[0,1,9]{1} received|[4-5]{1}\\[0,1,9]{1} packets received&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 7\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206022) *\nRule: &amp;#x27;clear_session(.*?)anomaly: icmp_flood, 51 &amp;gt; threshold 50&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall DoS-policy\n    delete &amp;quot;111&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system zone\n    del &amp;quot;zone1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set action accept\n    set service &amp;quot;ALL&amp;quot;\n    set schedule always\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 11\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr6 &amp;quot;all&amp;quot;\n    set dstaddr6 &amp;quot;all&amp;quot;\n    set action accept\n    set service &amp;quot;ALL&amp;quot;\n    set schedule always\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206022\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206025\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206028\n\n&#34;}], &#34;testcases/test__826625.py::test__826625&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__826625.py::test__826625&#34;, &#34;duration&#34;: &#34;5 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__826625.py::test__826625&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;5 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    unset sync-session-ttl\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show full ips global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(826625) *\nRule: &amp;#x27;sync-session-ttl enable&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 826625\n\n&#34;}], &#34;testcases/test__826626.py::test__826626&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__826626.py::test__826626&#34;, &#34;duration&#34;: &#34;12 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__826626.py::test__826626&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;12 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set sync-session-ttl enable\n    set engine-count 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system session-ttl\n    set default 600\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set status enable\n    set action pass\n    set log enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: telnet 172.16.200.55\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(826626) *\nRule: &amp;#x27;login:&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: root\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(826626) *\nRule: &amp;#x27;Password:&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: Qa123456!\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(826626) *\nRule: &amp;#x27;#&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 1\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips filter set &amp;#x27;port 23&amp;#x27;\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: setvar -e &amp;quot;idle:(.*?) flag&amp;quot; -to i\n2026-02-25 19:24:19 [ WARNING] [fluent] setvar: Pattern &amp;#x27;idle:(.*?) flag&amp;#x27; not found in output\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: setvar -e &amp;quot;(?n)expire: (.*?)\r&amp;quot; -to e\n2026-02-25 19:24:19 [ WARNING] [fluent] setvar: Pattern &amp;#x27;expire: (.*?)\r&amp;#x27; not found in output\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: &amp;lt;intchange 600 - i&amp;gt;\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: compare -v1 i -v2 e -for 826626\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session filter src 10.1.100.22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session filter dst 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session filter dport 23\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(826626) *\nRule: &amp;#x27;timeout=600&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exit\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system session-ttl\n    unset default\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set engine-count 0\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 826626\n\n&#34;}], &#34;testcases/test__821652.py::test__821652&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__821652.py::test__821652&#34;, &#34;duration&#34;: &#34;9 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__821652.py::test__821652&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;9 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 50740\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 25 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: nc 172.16.200.55 80 &amp;lt; /root/BONET_test.TXT\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ctrl_c\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(821652) *\nRule: &amp;#x27;action=\\&amp;quot;dropped\\&amp;quot;(.*?)profile=\\&amp;quot;sensor-1\\&amp;quot;(.*?)backdoor: Vidar.Botnet&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    set nat disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 821652\n\n&#34;}], &#34;testcases/test__821653.py::test__821653&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__821653.py::test__821653&#34;, &#34;duration&#34;: &#34;12 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__821653.py::test__821653&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;12 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    set exclude-signatures none\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set application SCADA\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag test app ipsm 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(821653) *\nRule: &amp;#x27;Self Test: Passed&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 25 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: nc -4u 172.16.200.55 5512 &amp;lt; /root/31321.bin\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ctrl_c\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(821653) *\nRule: &amp;#x27;action=\\&amp;quot;dropped\\&amp;quot;(.*?)attackid=31321(.*?)profile=\\&amp;quot;sensor-1\\&amp;quot;(.*?)SCADA: ABB.Multiple.Products.RobNetScanHost.exe.Stack.Buffer.Overflow&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips global\n    unset exclude-signatures\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 821653\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 1146048\n\n&#34;}], &#34;testcases/test__749201.py::test__749201&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__749201.py::test__749201&#34;, &#34;duration&#34;: &#34;26 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__749201.py::test__749201&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;26 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config user local\n    edit &amp;quot;test&amp;quot;\n    set type password\n    set passwd Qa123456!\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config user setting\n    set auth-type http https ftp telnet\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    edit &amp;quot;match small&amp;quot;\n    set signature &amp;quot;F-SBID( --attack_id 5835;  --name &amp;quot;match small&amp;quot;; --default_action reset; --service http; --protocol tcp; --pattern &amp;quot;small&amp;quot;; --severity info; --status disable; )&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: match small\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 5835\n    set status enable\n    set action pass\n    next\n    edit 2\n    set rule 29844\n    set status enable\n    set action block\n    next\n    edit 3\n    set rule 31129\n    set status enable\n    set action reset\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set users &amp;quot;test&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: mytelnet -d pc -u test -p Qa123456! -ip 172.16.200.55 -e &amp;quot;successful&amp;quot; -for 749201 -t 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia firewall auth list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;PC_01:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;test&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 10 -S --delete-after 172.16.200.55/ips_data/text\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;100%&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 10 -S --delete-after 172.16.200.55/ips_data/1.mp4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;Connection reset by peer&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk -m 15 https://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia firewall auth clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;action=\\&amp;quot;dropped\\&amp;quot;(.*?)service=\\&amp;quot;HTTPS\\&amp;quot;(.*?)attackid=29844(.*?)user=\\&amp;quot;test\\&amp;quot;(.*?)file_transfer: Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;action=\\&amp;quot;reset\\&amp;quot;(.*?)service=\\&amp;quot;HTTP\\&amp;quot;(.*?)attackid=31129(.*?)user=\\&amp;quot;test\\&amp;quot;(.*?)applications3: Adobe.Flash.MP4.Atoms.Invalid.Length.Memory.Corruption&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;action=\\&amp;quot;detected\\&amp;quot;(.*?)service=\\&amp;quot;HTTP\\&amp;quot;(.*?)attackid=5835(.*?)user=\\&amp;quot;test\\&amp;quot;(.*?)custom: match small&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter field dstip 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;user=\\&amp;quot;test\\&amp;quot;(.*?)utmaction=\\&amp;quot;reset\\&amp;quot;(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;user=\\&amp;quot;test\\&amp;quot;(.*?)utmaction=\\&amp;quot;block\\&amp;quot;(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;user=\\&amp;quot;test\\&amp;quot;(.*?)utmaction=\\&amp;quot;allow\\&amp;quot;(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    edit &amp;quot;app-list-1&amp;quot;\n    set other-application-log enable\n    config entries\n    edit 1\n    set category 5\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    unset ips-sensor\n    set application-list &amp;quot;app-list-1&amp;quot;\n    set users &amp;quot;test&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: mytelnet -d pc -u test -p Qa123456! -ip 172.16.200.55 -e &amp;quot;successful&amp;quot; -for 749201 -t 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia firewall auth list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;PC_01:IP_ETH1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;test&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v 172.16.200.55/app_data/story.mp3 -m 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;Application Blocked&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(749201) *\nRule: &amp;#x27;user=\\&amp;quot;test\\&amp;quot;(.*?)service=\\&amp;quot;HTTP\\&amp;quot;(.*?)applist=\\&amp;quot;app-list-1\\&amp;quot;(.*?)action=\\&amp;quot;block\\&amp;quot;(.*?)Video\\/Audio: HTTP.Audio&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia firewall auth clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    unset users\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    del &amp;quot;app-list-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config user local\n    del &amp;quot;test&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config user setting\n    unset auth-type\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 749201\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 816006\n\n&#34;}], &#34;testcases/test__853435.py::test__853435&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__853435.py::test__853435&#34;, &#34;duration&#34;: &#34;11 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__853435.py::test__853435&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;11 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set inspection-mode proxy\n    set http-policy-redirect enable\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action reset\n    set log enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set proxy transparent-web\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT1&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;webproxy&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v http://172.16.200.55/virus/eicar -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(853435) *\nRule: &amp;#x27;Intrusion Prevention Triggered&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk https://172.16.200.55/virus/eicar -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(853435) *\nRule: &amp;#x27;Intrusion Prevention Triggered|transfer closed with 68 bytes remaining to read|Empty reply from server&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(853435) *\nRule: &amp;#x27;action=\\&amp;quot;reset(.*?)service=\\&amp;quot;HTTPS\\&amp;quot;(.*?)dstport=443(.*)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(853435) *\nRule: &amp;#x27;action=\\&amp;quot;reset(.*?)service=\\&amp;quot;HTTP(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(853435) *\nRule: &amp;#x27;service=\\&amp;quot;HTTPS(.*?)policytype=\\&amp;quot;proxy-policy(.*?)utmaction=\\&amp;quot;reset(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(853435) *\nRule: &amp;#x27;service=\\&amp;quot;HTTP(.*?)policytype=\\&amp;quot;proxy-policy(.*?)utmaction=\\&amp;quot;reset(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    unset profile-protocol-options\n    set utm-status disable\n    unset inspection-mode\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 853435\n\n&#34;}], &#34;testcases/test__946656.py::test__946656&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__946656.py::test__946656&#34;, &#34;duration&#34;: &#34;11 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__946656.py::test__946656&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;11 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sys ips\n    set signature-hold-time 2d\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show sys ips\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sys ips\n    show full\n        \n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946656) *\nRule: &amp;#x27;set signature-hold-time 0h&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: set signature-hold-time 2d2h\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show full\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946656) *\nRule: &amp;#x27;set signature-hold-time 2d2h&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946656) *\nRule: &amp;#x27;override-signature-hold-by-id enable&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: set override-signature-hold-by-id disable\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show sys ips\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946656) *\nRule: &amp;#x27;set signature-hold-time 2d2h&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946656) *\nRule: &amp;#x27;override-signature-hold-by-id disable&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sys ips\n    unset override-signature-hold-by-id\n    unset signature-hold-time\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show sys ips\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 946656\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 946657\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 946667\n\n&#34;}], &#34;testcases/test__946659.py::test__946659&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__946659.py::test__946659&#34;, &#34;duration&#34;: &#34;13 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__946659.py::test__946659&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;13 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system ntp\n    set ntpsync disable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system global\n    set timezone Europe\\/London\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: execute date 2022-09-09\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sys ips\n    set signature-hold-time 2d\n    set override-signature-hold-by-id disable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips signature on-hold vd1 29844\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946659) *\nRule: &amp;#x27;Rule: 29844(.*?)last updated&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips signature on-hold vd1 29844\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946659) *\nRule: &amp;#x27;Rule: 29844(.*?)last updated&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20  http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946659) *\nRule: &amp;#x27;200 OK&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946659) *\nRule: &amp;#x27;signature(.*?)detected(.*?)Eicar.Virus.Test.File(.*?)(signature is on hold)&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sys ips\n    unset override-signature-hold-by-id\n    unset signature-hold-time\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system ntp\n    set ntpsync enable\n    set syncinterval 30\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system global\n    set timezone Canada\\/Pacific\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 946659\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 946660\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 946661\n\n&#34;}], &#34;testcases/test__946668.py::test__946668&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__946668.py::test__946668&#34;, &#34;duration&#34;: &#34;13 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__946668.py::test__946668&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;13 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system ntp\n    set ntpsync disable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system global\n    set timezone Europe\\/London\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: execute date 2022-09-09\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sys ips\n    set signature-hold-time 2d\n    set override-signature-hold-by-id enable\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set nat enable\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips signature on-hold vd1 29844\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946668) *\nRule: &amp;#x27;Rule: 29844(.*?)last updated&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20  http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946668) *\nRule: &amp;#x27;Connection timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(946668) *\nRule: &amp;#x27;signature(.*?)dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;sensor-1&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sys ips\n    unset override-signature-hold-by-id\n    unset signature-hold-time\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system ntp\n    set ntpsync enable\n    set syncinterval 30\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system global\n    set timezone Canada\\/Pacific\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 946668\n\n&#34;}], &#34;testcases/test__947031.py::test__947031&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__947031.py::test__947031&#34;, &#34;duration&#34;: &#34;8 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__947031.py::test__947031&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;8 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;g-cve&amp;quot;\n    set comment &amp;quot;cve-GLOBAL&amp;quot;\n    config entries\n    edit 1\n    set cve &amp;quot;cve-2010-0177&amp;quot;\n    set status enable\n    set log-packet enable\n    set action block\n    next\n    edit 2\n    set cve &amp;quot;CVE-2010&amp;quot;\n    set action reset\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show ips sensor g-cve\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947031) *\nRule: &amp;#x27;cve-2010-0177&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947031) *\nRule: &amp;#x27;CVE-2010&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;cve&amp;quot;\n    set comment &amp;quot;cve-GLOBAL&amp;quot;\n    config entries\n    edit 1\n    set cve &amp;quot;cve-2010-4091&amp;quot;\n    set status enable\n    set log-packet enable\n    set action block\n    next\n    edit 2\n    set cve &amp;quot;CVE-2010&amp;quot;\n    set action reset\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show ips sensor cve\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947031) *\nRule: &amp;#x27;cve-2010-4091&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947031) *\nRule: &amp;#x27;CVE-2010&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;g-cve&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;cve&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 947031\n\n&#34;}], &#34;testcases/test__947032.py::test__947032&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__947032.py::test__947032&#34;, &#34;duration&#34;: &#34;16 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__947032.py::test__947032&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;16 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit  &amp;quot;cve&amp;quot;\n    config entries\n    edit 1\n    set cve &amp;quot;CVE-2012-0754&amp;quot;\n    set status enable\n    set log-packet enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;cve&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v http://172.16.200.55/ips_data/1.mp4 -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947032) *\nRule: &amp;#x27;Operation timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947032) *\nRule: &amp;#x27;action=\\&amp;quot;dropped(.*?)service=\\&amp;quot;HTTP(.*?)dstport=80(.*)direction=\\&amp;quot;incoming(.*?)Adobe.Flash.MP4.Atoms.Invalid.Length.Memory.Corruption&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: setvar -e &amp;quot;incidentserialno=(.*?) msg&amp;quot; -to SRNO\n2026-02-25 19:24:19 [ WARNING] [fluent] setvar: Pattern &amp;#x27;incidentserialno=(.*?) msg&amp;#x27; not found in output\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: fnsysctl ls -l  /var/log/log/vd1/pcap\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: varexpect -v &amp;quot;None&amp;quot; -for 947034 -t 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947032) *\nRule: &amp;#x27;HTTP(.*?)block(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit  &amp;quot;cve&amp;quot;\n    config entries\n    edit 1\n    set action reset\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v http://172.16.200.55/ips_data/1.mp4 -m 15\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947032) *\nRule: &amp;#x27;Connection reset by peer&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947032) *\nRule: &amp;#x27;action=\\&amp;quot;reset(.*?)service=\\&amp;quot;HTTP(.*?)dstport=80(.*)direction=\\&amp;quot;incoming(.*?)Adobe.Flash.MP4.Atoms.Invalid.Length.Memory.Corruption&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit  &amp;quot;cve&amp;quot;\n    config entries\n    edit 1\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips ssl clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v http://172.16.200.55/ips_data/1.mp4 -O\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947032) *\nRule: &amp;#x27;200 OK&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(947032) *\nRule: &amp;#x27;action=\\&amp;quot;detected(.*?)service=\\&amp;quot;HTTP(.*?)dstport=80(.*)direction=\\&amp;quot;incoming(.*?)Adobe.Flash.MP4.Atoms.Invalid.Length.Memory.Corruption&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;cve&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 947032\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 947034\n\n&#34;}], &#34;testcases/test__983978.py::test__983978&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__983978.py::test__983978&#34;, &#34;duration&#34;: &#34;10 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__983978.py::test__983978&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;10 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sctp-filter profile\n    edit &amp;quot;g-sctp&amp;quot;\n    set comment &amp;#x27;&amp;#x27;\n    config ppid-filters\n    edit 1\n    set ppid 1773535488\n    set action reset\n    set comment &amp;#x27;test ppid&amp;#x27;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show full sctp-filter profile g-sctp\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983978) *\nRule: &amp;#x27;ppid 1773535488(.*?)reset(.*?)test ppid&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sctp-filter profile\n    edit &amp;quot;g-sctp&amp;quot;\n    config ppid-filters\n    edit 1\n    set action replace\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show sctp-filter profile g-sctp\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983978) *\nRule: &amp;#x27;ppid 1773535488(.*?)replace(.*?)test ppid&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sctp-filter profile\n    edit &amp;quot;g-sctp&amp;quot;\n    config ppid-filters\n    edit 1\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show sctp-filter profile g-sctp\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983978) *\nRule: &amp;#x27;ppid 1773535488(.*?)pass(.*?)test ppid&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sctp-filter profile\n    edit &amp;quot;sctp&amp;quot;\n    set comment &amp;#x27;&amp;#x27;\n    config ppid-filters\n    edit 1\n    set ppid 1773535488\n    set action reset\n    set comment &amp;#x27;test ppid&amp;#x27;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show full sctp-filter profile sctp\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983978) *\nRule: &amp;#x27;ppid 1773535488(.*?)reset(.*?)test ppid&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sctp-filter profile\n    edit &amp;quot;sctp&amp;quot;\n    config ppid-filters\n    edit 1\n    set action replace\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show sctp-filter profile sctp\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983978) *\nRule: &amp;#x27;ppid 1773535488(.*?)replace(.*?)test ppid&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sctp-filter profile\n    edit &amp;quot;sctp&amp;quot;\n    config ppid-filters\n    edit 1\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: show sctp-filter profile sctp\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983978) *\nRule: &amp;#x27;ppid 1773535488(.*?)pass(.*?)test ppid&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 983978\n\n&#34;}], &#34;testcases/test__983980.py::test__983980&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__983980.py::test__983980&#34;, &#34;duration&#34;: &#34;17 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__983980.py::test__983980&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;17 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sctp-filter profile\n    edit &amp;quot;sctp&amp;quot;\n    set comment &amp;#x27;&amp;#x27;\n    config ppid-filters\n    edit 1\n    set ppid 1773535488\n    set action reset\n    set comment &amp;#x27;test ppid&amp;#x27;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set sctp-filter-profile &amp;quot;sctp&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: python3 /root/server_sctp.py\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: python3 /root/client_sctp.py\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: killall -9 python3\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983980) *\nRule: &amp;#x27;sctp-filter(.*?)sctp-ppid-filter(.*?)action=\\&amp;quot;reset(.*)ppid=1773535488&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983980) *\nRule: &amp;#x27;sctp-filter(.*?)sctp-ppid-filter(.*?)action=\\&amp;quot;reset(.*)ppid=1773535488&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983980) *\nRule: &amp;#x27;utmaction=\\&amp;quot;block(.*?)countsctpf=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sctp-filter profile\n    edit &amp;quot;sctp&amp;quot;\n    config ppid-filters\n    edit 1\n    set action replace\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: python3 /root/server_sctp.py\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: python3 /root/client_sctp.py\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: killall -9 python3\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983980) *\nRule: &amp;#x27;sctp-filter(.*?)sctp-ppid-filter(.*?)action=\\&amp;quot;replace(.*)ppid=1773535488&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983980) *\nRule: &amp;#x27;utmaction=\\&amp;quot;block(.*?)countsctpf=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sctp-filter profile\n    edit &amp;quot;sctp&amp;quot;\n    config ppid-filters\n    edit 1\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: python3 /root/server_sctp.py\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: python3 /root/client_sctp.py\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983980) *\nRule: &amp;#x27;DLROW OLLEH&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: killall -9 python3\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983980) *\nRule: &amp;#x27;sctp-filter(.*?)sctp-ppid-filter(.*?)action=\\&amp;quot;pass(.*)ppid=1773535488&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(983980) *\nRule: &amp;#x27;utmaction=\\&amp;quot;allow(.*?)countsctpf=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config sctp-filter profile\n    del &amp;quot;sctp&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 983980\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 983981\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 983982\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 983987\n\n&#34;}], &#34;testcases/test__895490.py::test__895490&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__895490.py::test__895490&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__895490.py::test__895490&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;ips-ngfw&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action reset\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall security-policy\n    edit 99\n    set utm-status enable\n    set app-category 12 15\n    set ips-sensor &amp;quot;ips-ngfw&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 https://172.16.200.55 --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 https://172.16.200.55/virus/eicar --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895490) *\nRule: &amp;#x27;Connection reset by peer&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895490) *\nRule: &amp;#x27;reset(.*?)service=\\&amp;quot;HTTPS(.*?)policyid=99(.*?)dstport=443(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)ips-ngfw(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895490) *\nRule: &amp;#x27;policyid=99(.*?)policytype=\\&amp;quot;security-policy(.*?)service=\\&amp;quot;HTTPS(.*?)utmaction=\\&amp;quot;reset(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall security-policy\n    edit 99\n    unset ips-sensor\n    unset app-category\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;ips-ngfw&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 895490\n\n&#34;}], &#34;testcases/test__895491.py::test__895491&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__895491.py::test__895491&#34;, &#34;duration&#34;: &#34;8 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__895491.py::test__895491&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;8 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips custom\n    edit &amp;quot;match small&amp;quot;\n    set signature &amp;quot;F-SBID( --attack_id 5835;  --name &amp;quot;match small&amp;quot;; --default_action pass; --protocol tcp; --pattern &amp;quot;small&amp;quot;; --context file; --severity info; )&amp;quot;\n    set comment &amp;#x27;&amp;#x27;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [mock_device] [FGT_A] Stored signature: match small\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;ips-ngfw&amp;quot;\n    config entries\n    edit 1\n    set rule 5835\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall security-policy\n    edit 99\n    set utm-status enable\n    set app-category 12 15\n    set ips-sensor &amp;quot;ips-ngfw&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 https://172.16.200.55 --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 ftp://172.16.200.55/pub/text\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895491) *\nRule: &amp;#x27;Data connection: Connection timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895491) *\nRule: &amp;#x27;dropped(.*?)service=\\&amp;quot;FTP(.*?)policyid=99(.*?)attack=\\&amp;quot;match small(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)ips-ngfw&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895491) *\nRule: &amp;#x27;policyid=99(.*?)policytype=\\&amp;quot;security-policy(.*?)utmaction=\\&amp;quot;block(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall security-policy\n    edit 99\n    unset ips-sensor\n    unset app-category\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;ips-ngfw&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 895491\n\n&#34;}], &#34;testcases/test__895492.py::test__895492&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__895492.py::test__895492&#34;, &#34;duration&#34;: &#34;6 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__895492.py::test__895492&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;6 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;ips-ngfw&amp;quot;\n    config entries\n    edit 1\n    set severity critical\n    set status enable\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall security-policy\n    edit 99\n    set utm-status enable\n    set app-category 12 15\n    set ips-sensor &amp;quot;ips-ngfw&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 https://172.16.200.55 --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 15 http://172.16.200.55/ips_data/1.mp4 --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895492) *\nRule: &amp;#x27;100%&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895492) *\nRule: &amp;#x27;detected(.*?)service=\\&amp;quot;HTTP(.*?)dstport=80(.*?)direction=\\&amp;quot;incoming\\&amp;quot;(.*?)ips-ngfw(.*?)Adobe.Flash.MP4.Atoms.Invalid.Length.Memory.Corruption&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall security-policy\n    edit 99\n    unset ips-sensor\n    unset app-category\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;ips-ngfw&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 895492\n\n&#34;}], &#34;testcases/test__895497.py::test__895497&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__895497.py::test__895497&#34;, &#34;duration&#34;: &#34;16 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__895497.py::test__895497&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;16 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;ips-ngfw&amp;quot;\n    set scan-botnet-connections block\n    config entries\n    edit 1\n    set severity high\n    set status enable\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall security-policy\n    edit 99\n    set utm-status enable\n    set app-category 25\n    set ips-sensor &amp;quot;ips-ngfw&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys botnet-ip flush\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys botnet-ip list 0 50 | grep &amp;#x27;port=80-80&amp;#x27;\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: setvar -e &amp;quot;ip=(.*?)-&amp;quot; -to IPADDR\n2026-02-25 19:24:19 [ WARNING] [fluent] setvar: Pattern &amp;#x27;ip=(.*?)-&amp;#x27; not found in output\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys botnet-ip list 0 50 | grep &amp;#x27;port=80-80&amp;#x27;\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: setvar -e &amp;quot;botnet=(.*?), hit_count&amp;quot; -to RULEID\n2026-02-25 19:24:19 [ WARNING] [fluent] setvar: Pattern &amp;#x27;botnet=(.*?), hit_count&amp;#x27; not found in output\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config router static\n    edit 2\n    set dst {$IPADDR} 255.255.255.0\n    set gateway 172.16.200.2\n    set device &amp;quot;PORT1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system interface\n    edit &amp;quot;loopback&amp;quot;\n    set vdom &amp;quot;root&amp;quot;\n    set ip {$IPADDR} 255.255.255.255\n    set allowaccess ping https ssh snmp http telnet fgfm\n    set type loopback\n    next\n    edit &amp;quot;PORT1&amp;quot;\n    set mode static\n    set vdom &amp;quot;root&amp;quot;\n    set ip 172.16.200.2 255.255.255.0\n    set allowaccess ping https ssh snmp http telnet fgfm\n    set type physical\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set srcintf &amp;quot;PORT1&amp;quot;\n    set dstintf &amp;quot;loopback&amp;quot;\n    set action accept\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set nat enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 https://172.16.200.55 --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v -m 5 http://None\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895497) *\nRule: &amp;#x27;Operation timed out&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895497) *\nRule: &amp;#x27;botnet(.*?)dropped(.*?)ips-ngfw(.*?)&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;ips-ngfw&amp;quot;\n    set scan-botnet-connections monitor\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 https://172.16.200.55 --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -v -m 5 http://None\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 10\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895497) *\nRule: &amp;#x27;Operation timed out|Connection reset by peer|301 Moved|302 Found&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895497) *\nRule: &amp;#x27;botnet(.*?)detected(.*?)ips-ngfw(.*?)&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(895497) *\nRule: &amp;#x27;policyid=99(.*?)policytype=\\&amp;quot;security-policy(.*?)service=\\&amp;quot;HTTP(.*?)utmaction=\\&amp;quot;allow(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall security-policy\n    edit 99\n    unset ips-sensor\n    unset app-category\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    del &amp;quot;ips-ngfw&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config router static\n    del 2\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config system interface\n    edit &amp;quot;loopback&amp;quot;\n    unset ip\n    next\n    edit &amp;quot;PORT1&amp;quot;\n    unset ip\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    del 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 895497\n\n&#34;}], &#34;testcases/test__206088.py::test__206088&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__206088.py::test__206088&#34;, &#34;duration&#34;: &#34;10 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__206088.py::test__206088&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;10 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_26.3:Busy: block large_icmp signature with quarantine attacker\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    sleep 5\n    edit &amp;quot;111&amp;quot;\n    set status enable\n    set log enable\n    set action block\n    set quarantine attacker\n    set quarantine-expiry 3m\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 5 172.16.200.55\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 25 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -s 45000 -c 5 172.16.200.55\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206088) *\nRule: &amp;#x27;0 received|0 packets received&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206088) *\nRule: &amp;#x27;dropped(.*?) ICMP.Oversized.Packet&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 7\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip list\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206088) *\nRule: &amp;#x27;172.16.200.11(.*)IPS&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 1 172.16.200.55\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206088) *\nRule: &amp;#x27;0 received|0 packets received&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 1 172.16.200.3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206088) *\nRule: &amp;#x27;0 received|0 packets received&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_02\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: ping -c 1 172.16.200.55\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206088) *\nRule: &amp;#x27;64 bytes&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia user banned-ip clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    delete &amp;quot;111&amp;quot;\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206088\n\n&#34;}], &#34;testcases/test__206354.py::test__206354&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__206354.py::test__206354&#34;, &#34;duration&#34;: &#34;11 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__206354.py::test__206354&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;11 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_10.2:Busy: enable Winnuke.Windows.Out.Of.Band.Dos signature with action pass\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 29844\n    set status enable\n    set rule 29844\n    set action pass\n    set log enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    edit 2\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206354) *\nRule: &amp;#x27;signature(.*?)detected(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_010.2:Busy: enable winnuke_windows_out_of_band_dos signature with action block\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 29844\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 -S --delete-after http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 20\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206354) *\nRule: &amp;#x27;signature(.*?)dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set utm-status disable\n    next\n    edit 2\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    delete 29844\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206354\n\n&#34;}], &#34;testcases/test__206031.py::test__206031&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__206031.py::test__206031&#34;, &#34;duration&#34;: &#34;10 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__206031.py::test__206031&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;10 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_19.1:Busy: enable large_icmp signature with action pass\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    edit 1\n    set status enable\n    set rule 29844\n    set action pass\n    set log enable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy\n    edit 1\n    set interface port2\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set ips-sensor-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206031) *\nRule: &amp;#x27;68/68&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206031) *\nRule: &amp;#x27;detected(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment REGR_IPS_019.1:Busy: enable large_icmp signature with action block\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 http://172.16.200.55/index.html\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 30\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: clear_buffer\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 20 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 22\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206031) *\nRule: &amp;#x27;Giving up&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 2\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(206031) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: keep_running 0\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall interface-policy\n    delete 1\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 206031\n\n&#34;}], &#34;testcases/test__729753.py::test__729753&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__729753.py::test__729753&#34;, &#34;duration&#34;: &#34;17 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__729753.py::test__729753&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;17 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Create ips sensor to detect eicar and add this sensor to firewall policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT3&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clear wad statistics\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config global\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download eicar via http\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: cp /var/www/virus/eicar /home/fosqa/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;100%&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check IPS log and then change action on signature to block\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;detected(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;service=\\&amp;quot;HTTP(.*?)utmaction=\\&amp;quot;allow(.*?)countips&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download eicar via http\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;Giving up&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check IPS log and then change action on signature to reset\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;service=\\&amp;quot;HTTP(.*?)utmaction=\\&amp;quot;block(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action reset\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download eicar via ftp\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 ftp://fosqa:&amp;quot;Qa123456!&amp;quot;@172.16.200.55/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;Data transfer aborted&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check IPS log\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;reset(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;dstport=21(.*?)service=\\&amp;quot;FTP(.*?)action=\\&amp;quot;accept&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check that traffic goes through tunnel\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diagnose wad stats worker.protos show | grep &amp;quot;http.tunnel&amp;quot;\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;tunnel.bytes_in.*?([1-9][0-9]*).*?tunnel.bytes_out.*?([1-9][0-9]*)&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diagnose wad stats worker.protos show | grep &amp;quot;protos.ftp&amp;quot;\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(729753) *\nRule: &amp;#x27;tunnel.bytes_in.*?([1-9][0-9]*).*?tunnel.bytes_out.*?([1-9][0-9]*)&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clean up environment\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    unset ips-sensor\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_05\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: rm /home/fosqa/eicar\n2026-02-25 19:24:19 [    INFO] [mock_device] [PC_05] Deleted file: eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 729753\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 746987\n\n&#34;}], &#34;testcases/test__755618.py::test__755618&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__755618.py::test__755618&#34;, &#34;duration&#34;: &#34;18 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__755618.py::test__755618&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;18 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Create ips sensor to detect eicar and add this sensor to firewall proxy-policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action pass\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clear wad statistics\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download eicar via http\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755618) *\nRule: &amp;#x27;100%&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check IPS log and then change action on signature to block\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755618) *\nRule: &amp;#x27;detected(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755618) *\nRule: &amp;#x27;service=\\&amp;quot;HTTP(.*?)utmaction=\\&amp;quot;allow(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download eicar via http\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755618) *\nRule: &amp;#x27;403 Forbidden|503 ERROR&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check IPS log and then change action on signature to reset\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755618) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755618) *\nRule: &amp;#x27;service=\\&amp;quot;HTTP(.*?)utmaction=\\&amp;quot;block(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set action reset\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download eicar via http\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 http://172.16.200.55/virus/eicar\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755618) *\nRule: &amp;#x27;403 Forbidden|503 ERROR&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check IPS log\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755618) *\nRule: &amp;#x27;reset(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755618) *\nRule: &amp;#x27;service=\\&amp;quot;HTTP(.*?)utmaction=\\&amp;quot;reset(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clean up environment\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 755618\n\n&#34;}], &#34;testcases/test__741646.py::test__741646&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__741646.py::test__741646&#34;, &#34;duration&#34;: &#34;9 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__741646.py::test__741646&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;9 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Create ips sensor to block eicar and add this sensor to firewall policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT3&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clear wad statistics\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download eicar via http\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 https://172.16.200.55/virus/eicar --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(741646) *\nRule: &amp;#x27;Giving up|403 Forbidden&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check IPS and traffic log\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(741646) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(741646) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(741646) *\nRule: &amp;#x27;dstport=443(.*?)utmaction=\\&amp;quot;block(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clean up environment\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    unset ips-sensor\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 741646\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 751049\n\n&#34;}], &#34;testcases/test__833686.py::test__833686&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__833686.py::test__833686&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__833686.py::test__833686&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Create application list to block HTTP.Audio and add this list to firewall policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    edit &amp;quot;app-list-1&amp;quot;\n    config entries\n    edit 1\n    set category 5\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    set srcintf &amp;quot;PORT2&amp;quot;\n    set dstintf &amp;quot;PORT3&amp;quot;\n    set srcaddr &amp;quot;all&amp;quot;\n    set dstaddr &amp;quot;all&amp;quot;\n    set action accept\n    set schedule &amp;quot;always&amp;quot;\n    set service &amp;quot;ALL&amp;quot;\n    set utm-status enable\n    set application-list &amp;quot;app-list-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: curl -vk https://172.16.200.55/app_data/story.mp3\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(833686) *\nRule: &amp;#x27;Application Blocked&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(833686) *\nRule: &amp;#x27;HTTPS(.*?)app-list-1(.*?)block(.*?)HTTP.Audio&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(833686) *\nRule: &amp;#x27;service=\\&amp;quot;HTTPS(.*?)utmaction=\\&amp;quot;block(.*?)countapp&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    edit &amp;quot;app-list-1&amp;quot;\n    config entries\n    edit 1\n    unset category\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall policy\n    edit 1\n    unset application-list\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 833686\n\n&#34;}], &#34;testcases/test__755617.py::test__755617&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__755617.py::test__755617&#34;, &#34;duration&#34;: &#34;8 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__755617.py::test__755617&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;8 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Create ips sensor to block eicar and add this sensor to firewall proxy-policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    edit 1\n    set rule 29844\n    set status enable\n    set action block\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set utm-status enable\n    set ips-sensor &amp;quot;sensor-1&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 25\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clear wad statistics\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Download eicar via http\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 https://172.16.200.55/virus/eicar --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755617) *\nRule: &amp;#x27;Giving up|503 ERROR|ERROR 403: Forbidden&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Check IPS and traffic log\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 4\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755617) *\nRule: &amp;#x27;dropped(.*?)Eicar.Virus.Test.File&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(755617) *\nRule: &amp;#x27;dstport=443(.*?)utmaction=\\&amp;quot;block(.*?)countips=1&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Clean up environment\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config ips sensor\n    edit &amp;quot;sensor-1&amp;quot;\n    config entries\n    purge\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 755617\n\n&#34;}], &#34;testcases/test__833690.py::test__833690&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__833690.py::test__833690&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__833690.py::test__833690&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: comment Create application list to block HTTP.Audio and add this list to firewall policy\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    edit &amp;quot;app-list-1&amp;quot;\n    config entries\n    edit 1\n    set category 5\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set utm-status enable\n    set application-list &amp;quot;app-list-1&amp;quot;\n    set profile-protocol-options &amp;quot;default&amp;quot;\n    set ssl-ssh-profile &amp;quot;new-deep-inspection&amp;quot;\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log delete-all\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 80\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: PC_01\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: wget -t 1 -T 5 https://172.16.200.55/app_data/story.mp3 --no-check-certificate\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 15\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(833690) *\nRule: &amp;#x27;403 Forbidden|503 ERROR&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_B\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag ips session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: diag sys session clear\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 5\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter device disk\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 10\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(833690) *\nRule: &amp;#x27;HTTPS(.*?)app-list-1(.*?)block(.*?)HTTP.Audio&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log filter category 0\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: exe log display\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 3\n2026-02-25 19:24:19 [ WARNING] [root] \n* Expect Failure(833690) *\nRule: &amp;#x27;service=\\&amp;quot;HTTPS(.*?)utmaction=\\&amp;quot;block(.*?)countapp&amp;#x27;\n&amp;#x27;fail_match&amp;#x27; Flag: False\nTimeout Timer: 5s\n\n\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config application list\n    edit &amp;quot;app-list-1&amp;quot;\n    config entries\n    edit 1\n    unset category\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: next\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: \n    config firewall proxy-policy\n    edit 1\n    set utm-status disable\n    next\n    end\n        \n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 833690\n\n&#34;}], &#34;testcases/test__819174.py::test__819174&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;testcases/test__819174.py::test__819174&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;testcases/test__819174.py::test__819174&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] TestBed configured to use MOCK devices\n2026-02-25 19:24:19 [    INFO] [root] Creating MOCK devices for testing\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for FHV_A, defaulting to MockFortiGate\n2026-02-25 19:24:19 [ WARNING] [mock_device] Unknown device type for GLOBAL, defaulting to MockFortiGate\n2026-02-25 19:24:19 [    INFO] [root] Created PytestExecutor for test: pytest_test\n\n------------------------------ Captured log call -------------------------------\n2026-02-25 19:24:19 [    INFO] [fluent] Switching to device: FGT_A\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: config vdom\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: edit vd1\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: dia de crashlog read | grep firmware -A 100\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: sleep 60\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: end\n2026-02-25 19:24:19 [    INFO] [fluent] Executing: report 819174\n\n&#34;}]}, &#34;renderCollapsed&#34;: [&#34;false&#34;], &#34;initialSort&#34;: &#34;result&#34;, &#34;title&#34;: &#34;test_report.html&#34;}"></div>
    <script>
      (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const { getCollapsedCategory, setCollapsedIds } = require('./storage.js')

class DataManager {
    setManager(data) {
        const collapsedCategories = [...getCollapsedCategory(data.renderCollapsed)]
        const collapsedIds = []
        const tests = Object.values(data.tests).flat().map((test, index) => {
            const collapsed = collapsedCategories.includes(test.result.toLowerCase())
            const id = `test_${index}`
            if (collapsed) {
                collapsedIds.push(id)
            }
            return {
                ...test,
                id,
                collapsed,
            }
        })
        const dataBlob = { ...data, tests }
        this.data = { ...dataBlob }
        this.renderData = { ...dataBlob }
        setCollapsedIds(collapsedIds)
    }

    get allData() {
        return { ...this.data }
    }

    resetRender() {
        this.renderData = { ...this.data }
    }

    setRender(data) {
        this.renderData.tests = [...data]
    }

    toggleCollapsedItem(id) {
        this.renderData.tests = this.renderData.tests.map((test) =>
            test.id === id ? { ...test, collapsed: !test.collapsed } : test,
        )
    }

    set allCollapsed(collapsed) {
        this.renderData = { ...this.renderData, tests: [...this.renderData.tests.map((test) => (
            { ...test, collapsed }
        ))] }
    }

    get testSubset() {
        return [...this.renderData.tests]
    }

    get environment() {
        return this.renderData.environment
    }

    get initialSort() {
        return this.data.initialSort
    }
}

module.exports = {
    manager: new DataManager(),
}

},{"./storage.js":8}],2:[function(require,module,exports){
const mediaViewer = require('./mediaviewer.js')
const templateEnvRow = document.getElementById('template_environment_row')
const templateResult = document.getElementById('template_results-table__tbody')

function htmlToElements(html) {
    const temp = document.createElement('template')
    temp.innerHTML = html
    return temp.content.childNodes
}

const find = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return elem.querySelector(selector)
}

const findAll = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return [...elem.querySelectorAll(selector)]
}

const dom = {
    getStaticRow: (key, value) => {
        const envRow = templateEnvRow.content.cloneNode(true)
        const isObj = typeof value === 'object' && value !== null
        const values = isObj ? Object.keys(value).map((k) => `${k}: ${value[k]}`) : null

        const valuesElement = htmlToElements(
            values ? `<ul>${values.map((val) => `<li>${val}</li>`).join('')}<ul>` : `<div>${value}</div>`)[0]
        const td = findAll('td', envRow)
        td[0].textContent = key
        td[1].appendChild(valuesElement)

        return envRow
    },
    getResultTBody: ({ testId, id, log, extras, resultsTableRow, tableHtml, result, collapsed }) => {
        const resultBody = templateResult.content.cloneNode(true)
        resultBody.querySelector('tbody').classList.add(result.toLowerCase())
        resultBody.querySelector('tbody').id = testId
        resultBody.querySelector('.collapsible').dataset.id = id

        resultsTableRow.forEach((html) => {
            const t = document.createElement('template')
            t.innerHTML = html
            resultBody.querySelector('.collapsible').appendChild(t.content)
        })

        if (log) {
            // Wrap lines starting with "E" with span.error to color those lines red
            const wrappedLog = log.replace(/^E.*$/gm, (match) => `<span class="error">${match}</span>`)
            resultBody.querySelector('.log').innerHTML = wrappedLog
        } else {
            resultBody.querySelector('.log').remove()
        }

        if (collapsed) {
            resultBody.querySelector('.collapsible > .col-result')?.classList.add('collapsed')
            resultBody.querySelector('.extras-row').classList.add('hidden')
        } else {
            resultBody.querySelector('.collapsible > .col-result')?.classList.remove('collapsed')
        }

        const media = []
        extras?.forEach(({ name, format_type, content }) => {
            if (['image', 'video'].includes(format_type)) {
                media.push({ path: content, name, format_type })
            }

            if (format_type === 'html') {
                resultBody.querySelector('.extraHTML').insertAdjacentHTML('beforeend', `<div>${content}</div>`)
            }
        })
        mediaViewer.setup(resultBody, media)

        // Add custom html from the pytest_html_results_table_html hook
        tableHtml?.forEach((item) => {
            resultBody.querySelector('td[class="extra"]').insertAdjacentHTML('beforeend', item)
        })

        return resultBody
    },
}

module.exports = {
    dom,
    htmlToElements,
    find,
    findAll,
}

},{"./mediaviewer.js":6}],3:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const storageModule = require('./storage.js')

const getFilteredSubSet = (filter) =>
    manager.allData.tests.filter(({ result }) => filter.includes(result.toLowerCase()))

const doInitFilter = () => {
    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)
}

const doFilter = (type, show) => {
    if (show) {
        storageModule.showCategory(type)
    } else {
        storageModule.hideCategory(type)
    }

    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)

    const sortColumn = storageModule.getSort()
    doSort(sortColumn, true)
}

module.exports = {
    doFilter,
    doInitFilter,
}

},{"./datamanager.js":1,"./sort.js":7,"./storage.js":8}],4:[function(require,module,exports){
const { redraw, bindEvents, renderStatic } = require('./main.js')
const { doInitFilter } = require('./filter.js')
const { doInitSort } = require('./sort.js')
const { manager } = require('./datamanager.js')
const data = JSON.parse(document.getElementById('data-container').dataset.jsonblob)

function init() {
    manager.setManager(data)
    doInitFilter()
    doInitSort()
    renderStatic()
    redraw()
    bindEvents()
}

init()

},{"./datamanager.js":1,"./filter.js":3,"./main.js":5,"./sort.js":7}],5:[function(require,module,exports){
const { dom, find, findAll } = require('./dom.js')
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const { doFilter } = require('./filter.js')
const {
    getVisible,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    getSortDirection,
    possibleFilters,
} = require('./storage.js')

const removeChildren = (node) => {
    while (node.firstChild) {
        node.removeChild(node.firstChild)
    }
}

const renderStatic = () => {
    const renderEnvironmentTable = () => {
        const environment = manager.environment
        const rows = Object.keys(environment).map((key) => dom.getStaticRow(key, environment[key]))
        const table = document.getElementById('environment')
        removeChildren(table)
        rows.forEach((row) => table.appendChild(row))
    }
    renderEnvironmentTable()
}

const addItemToggleListener = (elem) => {
    elem.addEventListener('click', ({ target }) => {
        const id = target.parentElement.dataset.id
        manager.toggleCollapsedItem(id)

        const collapsedIds = getCollapsedIds()
        if (collapsedIds.includes(id)) {
            const updated = collapsedIds.filter((item) => item !== id)
            setCollapsedIds(updated)
        } else {
            collapsedIds.push(id)
            setCollapsedIds(collapsedIds)
        }
        redraw()
    })
}

const renderContent = (tests) => {
    const sortAttr = getSort(manager.initialSort)
    const sortAsc = JSON.parse(getSortDirection())
    const rows = tests.map(dom.getResultTBody)
    const table = document.getElementById('results-table')
    const tableHeader = document.getElementById('results-table-head')

    const newTable = document.createElement('table')
    newTable.id = 'results-table'

    // remove all sorting classes and set the relevant
    findAll('.sortable', tableHeader).forEach((elem) => elem.classList.remove('asc', 'desc'))
    tableHeader.querySelector(`.sortable[data-column-type="${sortAttr}"]`)?.classList.add(sortAsc ? 'desc' : 'asc')
    newTable.appendChild(tableHeader)

    if (!rows.length) {
        const emptyTable = document.getElementById('template_results-table__body--empty').content.cloneNode(true)
        newTable.appendChild(emptyTable)
    } else {
        rows.forEach((row) => {
            if (!!row) {
                findAll('.collapsible td:not(.col-links', row).forEach(addItemToggleListener)
                find('.logexpander', row).addEventListener('click',
                    (evt) => evt.target.parentNode.classList.toggle('expanded'),
                )
                newTable.appendChild(row)
            }
        })
    }

    table.replaceWith(newTable)
}

const renderDerived = () => {
    const currentFilter = getVisible()
    possibleFilters.forEach((result) => {
        const input = document.querySelector(`input[data-test-result="${result}"]`)
        input.checked = currentFilter.includes(result)
    })
}

const bindEvents = () => {
    const filterColumn = (evt) => {
        const { target: element } = evt
        const { testResult } = element.dataset

        doFilter(testResult, element.checked)
        const collapsedIds = getCollapsedIds()
        const updated = manager.renderData.tests.map((test) => {
            return {
                ...test,
                collapsed: collapsedIds.includes(test.id),
            }
        })
        manager.setRender(updated)
        redraw()
    }

    const header = document.getElementById('environment-header')
    header.addEventListener('click', () => {
        const table = document.getElementById('environment')
        table.classList.toggle('hidden')
        header.classList.toggle('collapsed')
    })

    findAll('input[name="filter_checkbox"]').forEach((elem) => {
        elem.addEventListener('click', filterColumn)
    })

    findAll('.sortable').forEach((elem) => {
        elem.addEventListener('click', (evt) => {
            const { target: element } = evt
            const { columnType } = element.dataset
            doSort(columnType)
            redraw()
        })
    })

    document.getElementById('show_all_details').addEventListener('click', () => {
        manager.allCollapsed = false
        setCollapsedIds([])
        redraw()
    })
    document.getElementById('hide_all_details').addEventListener('click', () => {
        manager.allCollapsed = true
        const allIds = manager.renderData.tests.map((test) => test.id)
        setCollapsedIds(allIds)
        redraw()
    })
}

const redraw = () => {
    const { testSubset } = manager

    renderContent(testSubset)
    renderDerived()
}

module.exports = {
    redraw,
    bindEvents,
    renderStatic,
}

},{"./datamanager.js":1,"./dom.js":2,"./filter.js":3,"./sort.js":7,"./storage.js":8}],6:[function(require,module,exports){
class MediaViewer {
    constructor(assets) {
        this.assets = assets
        this.index = 0
    }

    nextActive() {
        this.index = this.index === this.assets.length - 1 ? 0 : this.index + 1
        return [this.activeFile, this.index]
    }

    prevActive() {
        this.index = this.index === 0 ? this.assets.length - 1 : this.index -1
        return [this.activeFile, this.index]
    }

    get currentIndex() {
        return this.index
    }

    get activeFile() {
        return this.assets[this.index]
    }
}


const setup = (resultBody, assets) => {
    if (!assets.length) {
        resultBody.querySelector('.media').classList.add('hidden')
        return
    }

    const mediaViewer = new MediaViewer(assets)
    const container = resultBody.querySelector('.media-container')
    const leftArrow = resultBody.querySelector('.media-container__nav--left')
    const rightArrow = resultBody.querySelector('.media-container__nav--right')
    const mediaName = resultBody.querySelector('.media__name')
    const counter = resultBody.querySelector('.media__counter')
    const imageEl = resultBody.querySelector('img')
    const sourceEl = resultBody.querySelector('source')
    const videoEl = resultBody.querySelector('video')

    const setImg = (media, index) => {
        if (media?.format_type === 'image') {
            imageEl.src = media.path

            imageEl.classList.remove('hidden')
            videoEl.classList.add('hidden')
        } else if (media?.format_type === 'video') {
            sourceEl.src = media.path

            videoEl.classList.remove('hidden')
            imageEl.classList.add('hidden')
        }

        mediaName.innerText = media?.name
        counter.innerText = `${index + 1} / ${assets.length}`
    }
    setImg(mediaViewer.activeFile, mediaViewer.currentIndex)

    const moveLeft = () => {
        const [media, index] = mediaViewer.prevActive()
        setImg(media, index)
    }
    const doRight = () => {
        const [media, index] = mediaViewer.nextActive()
        setImg(media, index)
    }
    const openImg = () => {
        window.open(mediaViewer.activeFile.path, '_blank')
    }
    if (assets.length === 1) {
        container.classList.add('media-container--fullscreen')
    } else {
        leftArrow.addEventListener('click', moveLeft)
        rightArrow.addEventListener('click', doRight)
    }
    imageEl.addEventListener('click', openImg)
}

module.exports = {
    setup,
}

},{}],7:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const storageModule = require('./storage.js')

const genericSort = (list, key, ascending, customOrder) => {
    let sorted
    if (customOrder) {
        sorted = list.sort((a, b) => {
            const aValue = a.result.toLowerCase()
            const bValue = b.result.toLowerCase()

            const aIndex = customOrder.findIndex((item) => item.toLowerCase() === aValue)
            const bIndex = customOrder.findIndex((item) => item.toLowerCase() === bValue)

            // Compare the indices to determine the sort order
            return aIndex - bIndex
        })
    } else {
        sorted = list.sort((a, b) => a[key] === b[key] ? 0 : a[key] > b[key] ? 1 : -1)
    }

    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const durationSort = (list, ascending) => {
    const parseDuration = (duration) => {
        if (duration.includes(':')) {
            // If it's in the format "HH:mm:ss"
            const [hours, minutes, seconds] = duration.split(':').map(Number)
            return (hours * 3600 + minutes * 60 + seconds) * 1000
        } else {
            // If it's in the format "nnn ms"
            return parseInt(duration)
        }
    }
    const sorted = list.sort((a, b) => parseDuration(a['duration']) - parseDuration(b['duration']))
    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const doInitSort = () => {
    const type = storageModule.getSort(manager.initialSort)
    const ascending = storageModule.getSortDirection()
    const list = manager.testSubset
    const initialOrder = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed', 'Skipped', 'Passed']

    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    if (type?.toLowerCase() === 'original') {
        manager.setRender(list)
    } else {
        let sortedList
        switch (type) {
        case 'duration':
            sortedList = durationSort(list, ascending)
            break
        case 'result':
            sortedList = genericSort(list, type, ascending, initialOrder)
            break
        default:
            sortedList = genericSort(list, type, ascending)
            break
        }
        manager.setRender(sortedList)
    }
}

const doSort = (type, skipDirection) => {
    const newSortType = storageModule.getSort(manager.initialSort) !== type
    const currentAsc = storageModule.getSortDirection()
    let ascending
    if (skipDirection) {
        ascending = currentAsc
    } else {
        ascending = newSortType ? false : !currentAsc
    }
    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    const list = manager.testSubset
    const sortedList = type === 'duration' ? durationSort(list, ascending) : genericSort(list, type, ascending)
    manager.setRender(sortedList)
}

module.exports = {
    doInitSort,
    doSort,
}

},{"./datamanager.js":1,"./storage.js":8}],8:[function(require,module,exports){
const possibleFilters = [
    'passed',
    'skipped',
    'failed',
    'error',
    'xfailed',
    'xpassed',
    'rerun',
]

const getVisible = () => {
    const url = new URL(window.location.href)
    const settings = new URLSearchParams(url.search).get('visible')
    const lower = (item) => {
        const lowerItem = item.toLowerCase()
        if (possibleFilters.includes(lowerItem)) {
            return lowerItem
        }
        return null
    }
    return settings === null ?
        possibleFilters :
        [...new Set(settings?.split(',').map(lower).filter((item) => item))]
}

const hideCategory = (categoryToHide) => {
    const url = new URL(window.location.href)
    const visibleParams = new URLSearchParams(url.search).get('visible')
    const currentVisible = visibleParams ? visibleParams.split(',') : [...possibleFilters]
    const settings = [...new Set(currentVisible)].filter((f) => f !== categoryToHide).join(',')

    url.searchParams.set('visible', settings)
    window.history.pushState({}, null, unescape(url.href))
}

const showCategory = (categoryToShow) => {
    if (typeof window === 'undefined') {
        return
    }
    const url = new URL(window.location.href)
    const currentVisible = new URLSearchParams(url.search).get('visible')?.split(',').filter(Boolean) ||
        [...possibleFilters]
    const settings = [...new Set([categoryToShow, ...currentVisible])]
    const noFilter = possibleFilters.length === settings.length || !settings.length

    noFilter ? url.searchParams.delete('visible') : url.searchParams.set('visible', settings.join(','))
    window.history.pushState({}, null, unescape(url.href))
}

const getSort = (initialSort) => {
    const url = new URL(window.location.href)
    let sort = new URLSearchParams(url.search).get('sort')
    if (!sort) {
        sort = initialSort || 'result'
    }
    return sort
}

const setSort = (type) => {
    const url = new URL(window.location.href)
    url.searchParams.set('sort', type)
    window.history.pushState({}, null, unescape(url.href))
}

const getCollapsedCategory = (renderCollapsed) => {
    let categories
    if (typeof window !== 'undefined') {
        const url = new URL(window.location.href)
        const collapsedItems = new URLSearchParams(url.search).get('collapsed')
        switch (true) {
        case !renderCollapsed && collapsedItems === null:
            categories = ['passed']
            break
        case collapsedItems?.length === 0 || /^["']{2}$/.test(collapsedItems):
            categories = []
            break
        case /^all$/.test(collapsedItems) || collapsedItems === null && /^all$/.test(renderCollapsed):
            categories = [...possibleFilters]
            break
        default:
            categories = collapsedItems?.split(',').map((item) => item.toLowerCase()) || renderCollapsed
            break
        }
    } else {
        categories = []
    }
    return categories
}

const getSortDirection = () => JSON.parse(sessionStorage.getItem('sortAsc')) || false
const setSortDirection = (ascending) => sessionStorage.setItem('sortAsc', ascending)

const getCollapsedIds = () => JSON.parse(sessionStorage.getItem('collapsedIds')) || []
const setCollapsedIds = (list) => sessionStorage.setItem('collapsedIds', JSON.stringify(list))

module.exports = {
    getVisible,
    hideCategory,
    showCategory,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    setSort,
    getSortDirection,
    setSortDirection,
    getCollapsedCategory,
    possibleFilters,
}

},{}]},{},[4]);
    </script>
  </footer>
  </body>
</html>