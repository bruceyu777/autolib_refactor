# 711282ï¼šVerify license status warning when unable contact FGD
#
###############################################

[FVM_A]
    comment: Verify license status warning when unable contract FGD
    # get license file name
    setlicense -t 04G -for SN -to lic

    execute restore vmlicense tftp FVM_A:LICENSE_DIR{$lic} FVM_A:LICENSE_SERVER

    #sleep 100
    get system status | grep 'Serial-Number' -A 3
    expect -e "FGVM04T" -for 711282 -t 5
    expect -e "License Status: Valid" -for 711282 -t 5
    expect -e "4 CPU/4 allowed" -for 711282 -t 5

    config router static
        edit 1
                set status disable
        next
    end

    sleep 5

    diag test update setup

    sleep 60

    get system status | grep 'License'
    expect -e "License Status: Warning" -for 711282 -t 10
    #expect -e "License Status: Pending" -for 711282 -t 10

    diag hardware sysinfo vm full | grep 'code'
    expect -e "502" -for 711282 -t 5

    config router static
         edit 1
              set status enable
         next
    end

    sleep 5
    diag test update setup

    sleep 200
    get system status | grep 'License'
    expect -e "License Status: Valid" -for 711282 -t 10

    report 711282

