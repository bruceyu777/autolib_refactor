# 827306ï¼šVerify FNDN license can be valided
# fortiguard settting default 
# 
#####################################################################

[FVM_B]
    ### 827306.txt ###
    comments: Verify FNDN license can be valided 

    # get license file name
    setlicense -t FNDN -for SN -to lic

    config system interface
        edit FVM_B:PORT1
            set vdom "root"
            set mode static
            set ip FVM_B:IPV4_PORT1 255.255.255.0
            set allowaccess ping https ssh http telnet
        next
    end
    
 
    #remove license
    #execute factoryreset2    
    
    execute restore vmlicense tftp FVM_B:LICENSE_DIR{$lic} FVM_B:LICENSE_SERVER
	
    get system status | grep 'Serial-Number' -A 3
    expect -e "FGVMXX" -for 827283 -t 5
    expect -e "License Status: Valid" -for 827306 -t 

    diag debug vm-print-license
    expect -e "Model: XX" -for 827306 -t 5
    expect -e "CPU: 1" -for 827305 -t 5
    expect -e "MEM: 2048" -for 827305 -t 5

    # check lenc mode 827288
    get system status | grep "License Status"
    expect -e "Low-Encryption\\(LENC\\)" -for 827288 -t 5

    diag debug vm-print-license
    expect -e "LENC: yes" -for 827288 -t 5

    # check expiration date 827286
    get system status | grep "License Expiration Date"
    expect -e "License Expiration Date: 202[0-9]-[01][0-9]-[0-3][0-9]" -for 827286 -t 5


    report 827305
    report 827306
    report 827283
    report 827288
    report 827286
   
