# Test Case ID: 797331
# Objective: Verify memory and disk log can be viewed
#
########################################################
[FVM_A]
    comment 797331:Busy:Verify memory and disk log can be viewed

    config log memory setting
        set status enable
    end

    config log memory filter
        set severity information
    ene

    config log disk setting
        set status enable
    end

    config log disk filter
        set severity information
    end

    exe log delete-all
    y
    sleep 2

config firewall policy
	edit 797331
		set name "797331"
		set srcintf "FVM_A:PORT2"
		set dstintf "FVM_A:PORT3"
		set srcaddr "all"
		set dstaddr "all"
		set action accept
		set schedule "always"
		set service "ALL"
		set action deny
                set logtraffic all
	next
end
  
diag sys session clear

[PC_01]
route -n

route del default
route add default gateway PC_05:FORTIVM01_PORT2_IPV4 dev eth1
	
ping -c 5 PC_01:DESTINATION4
expect -e "64 bytes from" -fail match -for 797331 -t 5


[FVM_A]
    diag sys session clear	
    exe log filter device disk 
    exe log filter category traffic
    exe log filter field subtype forward
    exe log filter field action deny
    exe log display
    expect -e "policyid=797331" -for 797331 -t 5

    exe log filter device memory
    exe log filter category traffic
    exe log filter field subtype forward
    exe log filter field action deny
    exe log display
    expect -e "policyid=797331" -for 797331 -t 5

    config firewall policy
     purge
     y
    end
	
    report 797331
