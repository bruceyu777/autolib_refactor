# 986461
# Verify sysObjID of VM model can be returned when license is invalid 
# test using s-license: sysObjID willl be FGVMSL(80021) 


[FVM_A]

    #load a expired license to VM
    setlicense -t EXG -for SN -to lic
    execute restore vmlicense tftp FVM_A:LICENSE_DIR{$lic} FVM_A:LICENSE_SERVER

    get system status | grep 'Serial-Number' -A 3
    expect -e "Expired" -for 986461 -t 90 

    # config snmp
    config system snmp sysinfo
        set status enable
    end

    config system snmp community
        edit 1
            set name "pub"
            config hosts
                edit 1
                    set ip 10.6.30.11 255.255.255.255
                next
            end
        next
    end

    config system interface
        edit FVM_A:PORT1
            set allowaccess ping https ssh http telnet snmp
        next
    end


[PC_01]

    snmpwalk -v2c -c pub FVM_A:IPV4_PORT1 iso.3.6.1.2.1.1.2.0
    expect -e "OID: iso.3.6.1.4.1.12356.101.1.60" -for 986461 -t 10

[FVM_A]
    config system snmp sysinfo
         set status disable
    end

    config system snmp community
        delete 1
    end 
   
    setlicense -t 04G -for SN -to lic
    execute restore vmlicense tftp FVM_A:LICENSE_DIR{$lic} FVM_A:LICENSE_SERVER
 
    get system status | grep 'License' -A 3
    #expect -e "License Status: Valid" -for 986461 -t 10
    report 986461

