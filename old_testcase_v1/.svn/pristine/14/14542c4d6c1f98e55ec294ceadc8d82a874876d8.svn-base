# 897191ï¼šVerify foc licence can be activates on 08V or highter vm 
# fortiguard settting default 
# 
#####################################################

[FVM_A]

    ### 897191.txt ###
    comments: Verify foc license activated on 08V or higher instance

    # get license file name
    setlicense -t FOCV -for SN -to lic
    setlicense -t FOCV -for VDOM -to foclic

    #remove license
    execute factoryreset2    
    
    get system status | grep 'Serial-Number' -A 3
    expect -e "License Status: Invalid" -for 897191 -t 5
    
    execute restore vmlicense tftp FVM_A:LICENSE_DIR{$lic} FVM_A:LICENSE_SERVER
	
    get system status | grep 'Serial-Number' -A 3
    expect -e "FGVM8V" -for 897191 -t 5
    expect -e "License Status: Valid" -for 897191 -t 5
    expect -e "4 CPU/8 allowed" -for 897191 -t 5

    diag debug vm-print-license
    expect -e "Model: 8V" -for 897191 -t 5
    expect -e "CPU: 8" -for 897191 -t 5

    execute forticarrier-license {$foclic}
    y

    get system status | grep "License Status"
    expect -e "FortiCarrier License Status: Carrier" -for 897191 -t 5

   # test 891699: keep minimal network setting

   show system interface FVM_A:PORT1
   expect -e "10.6.30.200" -for 891699 -t 5

   show router static
   expect -e "10.6.30.254" -for 891699 -t 5


   report 897191
   report 891699
   
