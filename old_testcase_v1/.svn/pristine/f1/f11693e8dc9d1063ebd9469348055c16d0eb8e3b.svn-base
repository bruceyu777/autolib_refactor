# 827280
# fndn: firewall policies have max of 10
###########################################


[FVM_A]
	comment 827280:"Firewall policies have max of 10 of each (policy4, policy6)"

	get system status
	expect -e "FGVMXX" -for 827280 -t 5
	
	config firewall policy
    	    purge
	    y
        end
	
    config firewall policy
        edit 1
	    set name "1"
        set srcintf "FVM_A:PORT2"
        set dstintf "FVM_A:PORT1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
    next
    edit 2
	set name "2"
        set srcintf "FVM_A:PORT2"
        set dstintf "FVM_A:PORT1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
    next
    edit 3
        set name "3"
        set srcintf "FVM_A:PORT2"
        set dstintf "FVM_A:PORT1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
    next
    edit 4
        set name "4"
        set srcintf "FVM_A:PORT2"
        set dstintf "FVM_A:PORT1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
    next
    edit 5
        set name "5"
        set srcintf "FVM_A:PORT2"
        set dstintf "FVM_A:PORT1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
    next
    edit 6
        set name "6"
        set srcintf "FVM_A:PORT2"
        set dstintf "FVM_A:PORT1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
    next
    edit 7
        set name "7"
        set srcintf "FVM_A:PORT2"
        set dstintf "FVM_A:PORT1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
    next
    edit 8
        set name "8"
        set srcintf "FVM_A:PORT2"
        set dstintf "FVM_A:PORT1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
    next
    edit 9
        set name "9"
        set srcintf "FVM_A:PORT2"
        set dstintf "FVM_A:PORT1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
    next
    edit 10
        set name "10"
        set srcintf "FVM_A:PORT2"
        set dstintf "FVM_A:PORT1"
        set srcaddr "all"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set nat enable
    next
end

	show firewall policy 10
        expect -e "edit 10"  -t 5 -for 827280

   	config firewall policy
      		clone 1 to 11
                clone 1 to 12
                clone 1 to 13
                clone 1 to 14
                clone 1 to 15
                clone 1 to 16
                clone 1 to 17
                clone 1 to 18
                clone 1 to 19
                clone 1 to 20 
                clone 1 to 21
   	end
	
	show firewall policy
	expect -e "edit 21" -fail match -t 5 -for 827280

	config firewall multicast-policy
		edit 1
                        set srcintf "FVM_A:PORT2"
                        set dstintf "FVM_A:PORT1"
                        set srcaddr "all"
                        set dstaddr "all"
                next
		clone 1 to 2
                clone 1 to 3
                clone 1 to 4
                clone 1 to 5
                clone 1 to 6
                clone 1 to 7
                clone 1 to 8
                clone 1 to 9
                clone 1 to 10
        end
	
	show firewall multicast-policy 10
	expect -e "edit 10"  -t 5 -for 827280

	config firewall multicast-policy
		 clone 1 to 11
	end

	show firewall multicast-policy 
	expect -e "edit 11" -fail match -t 5 -for 827280

        config firewall multicast-policy6        
		edit 1
                        set srcintf "FVM_A:PORT2"
                        set dstintf "FVM_A:PORT1"
                        set srcaddr "all"
                        set dstaddr "all"
                next
                clone 1 to 2
                clone 1 to 3
                clone 1 to 4
                clone 1 to 5
                clone 1 to 6
                clone 1 to 7
                clone 1 to 8
                clone 1 to 9
                clone 1 to 10
        end

        show firewall multicast-policy6 10
        expect -e "edit 10"  -t 5 -for 827280

        config firewall multicast-policy6
                 clone 1 to 11
        end

        show firewall multicast-policy6
        expect -e "edit 11" -fail match -t 5 -for 827280


    config firewall policy
 #    	purge
#	   	y
    end
    report 827280
#[FVM_A]
	config firewall multicast-policy
        purge
		y
	end

	config firewall multicast-policy6
		purge
		y
	end
 
 	report 827280
