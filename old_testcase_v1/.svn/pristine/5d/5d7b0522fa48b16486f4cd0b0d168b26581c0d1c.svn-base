# 1016492ï¼šVerify reboot can activate all CPU after loading s04-license
# 
# 
###############################################

[FVM_A]
    ### 1016492.txt ###
    comment: Verify reboot activate all CPU after loading s04-license
    setlicense -t 04S -for SN -to lic

    #remove license
    execute factoryreset2    
    
    sleep 60

    get system status | grep 'Serial-Number' -A 5
    expect -e "License Status: Invalid" -for 1016492 -t 5
    
    execute restore vmlicense tftp FVM_A:LICENSE_DIR{$lic} FVM_A:LICENSE_SERVER
    sleep 90
	
    get system status | grep 'Serial-Number' -A 5
    expect -e "FGVMSL" -for 1016492 -t 5
    expect -e "License Status: Valid" -for 1016492 -t 5
    expect -e "1 CPU/4 allowed" -for 1016492 -t 5

    #s-license need a reboot or exe cpu add to activate
    exe cpu show
    expect -e "Active CPU number: 1" -for 1016492 -t 10

    diag debug vm-print-license
    expect -e "Model: 18" -for 1016492 -t 5
    expect -e "CPU: 4" -for 1016492 -t 5

    execute reboot
    y 
    
    sleep 90

[FVM_A]
    admin
    admin
    get system status | grep 'Serial-Number' -A 5
    expect -e "License Status: Valid" -for 1016492 -t 5
    expect -e "4 CPU/4 allowed" -for 1016492 -t 5

    exe cpu show
    expect -e "Active CPU number: 4" -for 1016492 -t 10

    report 1016492
   
