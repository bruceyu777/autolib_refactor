# 986333
# M722589
# dmibs.py need to be under /tftpboot
# Verify FGT mib file contains object identifiler for VM license

[PC_KVM]
    comment downloading FORTINET-FORTIGATE-MIB-buildxxxx.mib from image server
    rm /tftpboot/*.mib
    /tftpboot/dmibs.py -c 7.2
    expect -e "LATEST 7.2 IMAGES" -for 986333 -t 30
    setvar -e "build(\\d{1,4})  <-" -to IMAGE_VERSION
    /tftpboot/dmibs.py -g -r 7.2 -b {$IMAGE_VERSION} -f FGT_VM64_KVM
    sleep 10
    #ls -al /tftpboot/*.mib
    #expect -e "(?n)(FORTINET-FORTIGATE-MIB-build{$IMAGE_VERSION}.mib)" -for 986333 -t 5
    cat /tftpboot/FORTINET-FORTIGATE-MIB-build{$IMAGE_VERSION}.mib | grep fgtARM64AWS
    expect -e "fgModel 90007" -for 986333 -t 5
    cat /tftpboot/FORTINET-FORTIGATE-MIB-build{$IMAGE_VERSION}.mib | grep fgtVM64KVm
    expect -e "fgModel 60" -for 986333 -t 5
    cat /tftpboot/FORTINET-FORTIGATE-MIB-build{$IMAGE_VERSION}.mib | grep fosVM64XEN
    expect -e "fgModel 41" -for 986333 -t 5

[FVM_A]
    get system status
    report 986333

