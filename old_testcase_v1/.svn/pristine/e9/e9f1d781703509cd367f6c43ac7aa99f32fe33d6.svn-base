# 993589ï¼šVerify g00-license can be valided
# fortiguard settting default 
# 1 CPU/2G MEM, Default VDom = 2 
#################################

[FVM_A]
    ### 993589.txt ###
    comment: Verify G00 can be valided base on cpu cores with default FGD setting

    # get license file name
    setlicense -t 00G -for SN -to lic
 
    #remove license
    execute factoryreset2    
    
    # 1015661 ev license is invalid with more than 1cpu, 2G mem
    get system status | grep 'Serial-Number' -A 5
    expect -e "FGVMEV" -for 1015661 -t 5
    expect -e "License Status: Invalid" -for 1015661 -t 5
    
    execute restore vmlicense tftp FVM_A:LICENSE_DIR{$lic} FVM_A:LICENSE_SERVER
	
    get system status | grep 'Serial-Number' -A 10 
    expect -e "FGVM00T" -for 993589 -t 5
    expect -e "License Status: Valid" -for 993589 -t 5
    expect -e "1 CPU/1 allowed" -for 993589 -t 5
    #expect -e "Max number of virtual domains: 2" -for 993589 -t 5

    diag debug vm-print-license
    expect -e "Model: 3" -for 993589 -t 5
    expect -e "CPU: 1" -for 993589 -t 5
    #expect -e "permanent: 2" -for 993589 -t 5


    report 993589
    report 1015661 
