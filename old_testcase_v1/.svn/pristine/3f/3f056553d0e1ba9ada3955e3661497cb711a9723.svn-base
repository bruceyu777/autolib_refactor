# 972419ï¼šVerify EV license support 1CPU/2G MEM, LENC
# fortiguard settting default 
# 
#####################################################################

[FVM_A]
    ### 972419.txt ###
    comments: Verify EV license support 1CPU/2G MEM, LENC

    get sys status | grep Serial-Number -A 3 
    expect -e "FGVMEV" -for 972419 -t 5
    expect -e "Valid" -for 972419 -t 5

    diagnose debug vm-print-license
    expect -e "Model: EVAL" -for 972419 -t 5
    expect -e "CPU: 1" -for 972419 -t 5
    expect -e "MEM: 2048" -for 972419 -t 5

    #ev license default dns protocol cleartext
    show full sys dns | grep protocol -B 2
    expect -e "96.45.45.45" -for 1008609 -t 5
    expect -e "protocol cleartext" -for 1008609 -t 5

   # low-enc not support anycast
    show full system fortiguard | grep fortiguard-anycast
    expect -e "fortiguard-anycast disable" -fail match -for 972419 -t 5

    #check low_encrption
    config log fortianalyzer setting
        set status enable
        set server 1.1.1.1
        set certificate-verification disable
        set enc-algorithm high
    end

    show full log fortianalyzer setting | grep enc-algorithm
    expect -e "enc-algorithm low" -for 972419 -t 5

    config log fortianalyzer setting
        set enc-algorithm high-medium
    end

    show full log fortianalyzer setting | grep enc-algorithm
    expect -e "enc-algorithm low" -for 972419 -t 5

    #ev license default dns protocol cleartext
    show full sys dns | grep protocol -B 2
    expect -e "96.45.45.45" -for 1008609 -t 5
    expect -e "protocol cleartext" -for 1008609 -t 5


    #972412
    diag autoupdate version | grep "IPS Attack Engine" -A 5
    expect -e "Version: 7.\\d{5,5}" -for 972421 -t 5

    diag autoupdate version | grep "Attack Definitions" -A 5
    expect -e "Version: 6.\\d{5,5}" -for 972421 -t 5

    diag autoupdate version | grep "AV Engine" -A 5
    expect -e "Version: 6.\\d{5,5}" -for 972421 -t 5


    diag autoupdate version | grep "Virus Definitions" -A 5
    expect -e "Version: 1.\\d{5,5}" -for 972421 -t 5

    diag autoupdate version | grep "Industrial Attack Definitions" -A 5
    expect -e "Version: 6.\\d{5,5}" -for 972421 -t 5

    config log fortianalyzer setting
        unser server
        set status disable
    end
    y

    report 972419
    report 972421
    report 1008609
   
