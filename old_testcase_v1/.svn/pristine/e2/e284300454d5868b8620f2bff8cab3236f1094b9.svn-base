# 986360
# Verify FGT can return correct sysObjID with valid license
# test using s-license: sysObjID willl be FGVMSL(80021)


[FVM_A]

    #load a s-license to VM
    setlicense -t 04S -for SN -to lic
    execute restore vmlicense tftp FVM_A:LICENSE_DIR{$lic} FVM_A:LICENSE_SERVER

    get system status | grep 'Serial-Number' -A 5
    expect -e "FGVMSL" -for 986360 -t 5

    # config snmp
    config system snmp sysinfo
        set status enable
    end

    config system snmp community
        edit 1
            set name "pub"
            config hosts
                edit 1
                    set ip 10.6.30.11 255.255.255.255
                next
            end
        next
    end

    config system interface
        edit FVM_A:PORT1
            set allowaccess ping https ssh http telnet snmp
        next
    end
    sleep 200
    get system status | grep 'License' -A 5
    expect -e "License Status: Valid" -for 986360 -t 10


[PC_02]

    snmpwalk -v2c -c pub FVM_A:IPV4_PORT1 1.3.6.1.2.1.1.2
    expect -e "iso.3.6.1.4.1.12356.101.1.80021" -for 986360 -t 10

[FVM_A]
    get system status
    # reset snmp config
    config system snmp sysinfo
        set status disable
    end

    config system snmp community
        delete 1
    next

    report 986360

