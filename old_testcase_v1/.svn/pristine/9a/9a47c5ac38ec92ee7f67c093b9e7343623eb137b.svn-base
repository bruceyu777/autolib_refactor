# 812961ï¼šVerify stackable vdom license and upload to fgtvm with g16-lic
#  
# 
#########################################################################

#[FVM_A]
    ### 812961.txt ###
    comment: Verify stackabel vdom license upgrade on vm with G16

    setlicense -t 16G -for SN -to lic
    #setlicense -t 16G -for VDOM -to vdlic
 
    #remove license
    execute factoryreset2    
    
    get system status | grep 'Serial-Number' -A 5
    #expect -e "License Status: Invalid" -for 812961 -t 5
    
    execute restore vmlicense tftp FVM_A:LICENSE_DIR{$lic} FVM_A:LICENSE_SERVER
	
    get system status | grep 'Serial-Number' -A 5
    #expect -e "FGVM08T" -for 812961 -t 5
    #expect -e "4 CPU/8 allowed" -for 812961 -t 5

[FVM_A]
    get system status | grep 'domain'
    #expect -e "Max number of virtual domains: 10" -for 812961 -t 10

    setlicense -t 16G -for VDOM -to vdlic

    # import vdom license 
    execute upd-vd-license {$vdlic}
    y
    sleep 10

    get system status | grep 'domain'
    #expect -e "Max number of virtual domains: 15" -for 812961 -t 10

    diag debug vm-print-license
    ##expect -e "permanent: 15" -for 812961 -t 5

    report 812961
   
