# Test Case ID: 1014991
# Objective: Verify disk log works on FFW 
#
########################################################
[FFW_A]
    comment 1014991:Busy:Verify FFW disk log

    config log disk setting
        set status enable
    end

    config log disk filter
        set severity information
    end

    exe log delete-all
    y
    sleep 2

    config system interface
        edit "FFW_A:PORT2"
            set vdom "root"
            set ip FFW_A:IPV4_PORT2 255.255.255.0
            set allowaccess ping https ssh http telnet
        next
        edit "FFW_A:PORT3"
            set vdom "root"
            set mode static
            set ip FFW_A:IPV4_PORT3 255.255.255.0
            set allowaccess ping https ssh http telnet
        next
   end

    config firewall policy
	edit 1014991
		set name "1014991"
		set srcintf "FFW_A:PORT2"
		set dstintf "FFW_A:PORT3"
		set srcaddr "all"
		set dstaddr "all"
		set schedule "always"
		set service "ALL"
		set action deny
                set logtraffic all 
	next
    end
  
    diag sys session clear

    diag log test

[PC_02]
    route -n
    route del -net 172.16.200.0 netmask 255.255.255.0
    route del -host 172.16.200.55

    route add -host 172.16.200.55 gw FFW_A:IPV4_PORT2
    route -n
    sleep 5

    ping -c 5 PC_02:DESTINATION4
    expect -e "64 bytes from" -fail match -for 1014991 -t 5


[FFW_A]
    diag sys session clear	
    
    exe log filter device disk
    exe log filter category traffic
    exe log filter field subtype forward
    exe log filter field action deny
    exe log display
    expect -e "policyid=1014991" -for 1014991 -t 5

    exe log filter device disk
    exe log filter category event
    exe log display
    expect -e "1: date" -for 1014991 -t 5

    config firewall policy
     purge
     y
    end
	
    report 1014991
